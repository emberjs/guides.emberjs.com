<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">

    <title>Ember.js - Routing: Preventing and Retrying Transitions</title>
    <meta property="st:title" content="Routing: Preventing and Retrying Transitions" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="../../images/favicon.png" rel="icon" type="image/png" />
    <!--[if lte IE 7 ]><link href="../../stylesheets/fonts/fontello-ie7.css" rel="stylesheet" /><![endif]-->
    <link href="../../stylesheets/application.css" rel="stylesheet" />

    <!-- This TypeKit account is managed by @wifelette. Contact her with any issues. -->
    <script src="https://use.typekit.net/stz3kpn.js"></script>
    <script>try{Typekit.load({ async: true });}catch(e){}</script>

    <link href="/blog/feed.xml" rel="alternate" type="application/atom+xml" title="Ember.js - Blog" />
    <link href="https://guides.emberjs.com/current/routing/preventing-and-retrying-transitions/" rel="canonical">
    
  </head>

  <body class="guides routing routing_preventing-and-retrying-transitions routing_preventing-and-retrying-transitions_index">

    <!--[if lt IE 9]>
      <script src="../../javascripts/common-old-ie.js"></script>
    <![endif]-->
    <!--[if gte IE 9]><!-->
      <script src="../../javascripts/common-modern.js"></script>
    <!--<![endif]-->

    <header class="header">
  <nav role="navigation" aria-label="main">
    <ul class="header-nav container">
      <li class="header-logo">
        <a href="http://emberjs.com/"><span class="visually-hidden">Ember homepage</span></a>
      </li>
      <li>
        <a href="http://emberjs.com/">About</a>
      </li>
      <li class="active" aria-label="You are here">
        <a href="/">Guides</a>
      </li>
      <li>
        <a href="http://emberjs.com/api">API</a>
      </li>
      <li>
        <a href="http://emberjs.com/community">Community</a>
      </li>
      <li>
        <a href="http://emberjs.com/blog">Blog</a>
      </li>
      <li>
        <a href="http://emberjs.com/builds">Builds</a>
      </li>

      <li class="header-search">
        <form>
          <input type="text" id="search-input" class="search-input" placeholder="Search the guides"/>
        </form>
      </li>
    </ul>
  </nav>
</header>


    

    <main class="container">
      <aside class="sidebar">
  <label for="version-select" class="visually-hidden">Guides version</label>
  <select class="version-select" id="version-select" style="width: 100%"></select>

  <input id="toc-toggle" class="toc-toggle visually-hidden" type="checkbox" />
  <label for="toc-toggle">Table of Contents <span class="visually-hidden">toggle</span></label>

  <nav class="toc-container" aria-label="table of contents">
    <ol class='toc-level-0 selected'><li class='toc-level-0 '><a href="#">Getting Started</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../getting-started/quick-start/">Quick Start</a></li><li class='toc-level-1 '><a href="../../getting-started/">Installing Ember</a></li><li class='toc-level-1 '><a href="../../getting-started/core-concepts/">Core Concepts</a></li></ol></li><li class='toc-level-0 '><a href="#">Tutorial</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../tutorial/ember-cli/">Creating Your App</a></li><li class='toc-level-1 '><a href="../../tutorial/acceptance-test/">Setting Up Tests</a></li><li class='toc-level-1 '><a href="../../tutorial/routes-and-templates/">Routes and Templates</a></li><li class='toc-level-1 '><a href="../../tutorial/model-hook/">The Model Hook</a></li><li class='toc-level-1 '><a href="../../tutorial/installing-addons/">Installing Addons</a></li><li class='toc-level-1 '><a href="../../tutorial/ember-data/">Using Ember Data</a></li><li class='toc-level-1 '><a href="../../tutorial/simple-component/">Building a Simple Component</a></li><li class='toc-level-1 '><a href="../../tutorial/hbs-helper/">Creating a Handlebars Helper</a></li><li class='toc-level-1 '><a href="../../tutorial/autocomplete-component/">Building a Complex Component</a></li><li class='toc-level-1 '><a href="../../tutorial/service/">Services and Utilities</a></li><li class='toc-level-1 '><a href="../../tutorial/deploying/">Deploying</a></li></ol></li><li class='toc-level-0 '><a href="#">The Object Model</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../object-model/">Objects in Ember</a></li><li class='toc-level-1 '><a href="../../object-model/classes-and-instances/">Classes and Instances</a></li><li class='toc-level-1 '><a href="../../object-model/reopening-classes-and-instances/">Reopening Classes and Instances</a></li><li class='toc-level-1 '><a href="../../object-model/computed-properties/">Computed Properties</a></li><li class='toc-level-1 '><a href="../../object-model/computed-properties-and-aggregate-data/">Computed Properties and Aggregate Data</a></li><li class='toc-level-1 '><a href="../../object-model/observers/">Observers</a></li><li class='toc-level-1 '><a href="../../object-model/bindings/">Bindings</a></li><li class='toc-level-1 '><a href="../../object-model/enumerables/">Enumerables</a></li></ol></li><li class='toc-level-0 selected'><a href="#">Routing</a><ol class='toc-level-1 selected'><li class='toc-level-1 '><a href="../">Introduction</a></li><li class='toc-level-1 '><a href="../defining-your-routes/">Defining Your Routes</a></li><li class='toc-level-1 '><a href="../specifying-a-routes-model/">Specifying a Route's Model</a></li><li class='toc-level-1 '><a href="../rendering-a-template/">Rendering a Template</a></li><li class='toc-level-1 '><a href="../redirection/">Redirecting</a></li><li class='toc-level-1 selected'><a href="./">Preventing and Retrying Transitions</a></li><li class='toc-level-1 '><a href="../loading-and-error-substates/">Loading / Error Substates</a></li><li class='toc-level-1 '><a href="../query-params/">Query Parameters</a></li><li class='toc-level-1 '><a href="../asynchronous-routing/">Asynchronous Routing</a></li></ol></li><li class='toc-level-0 '><a href="#">Templates</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../templates/handlebars-basics/">Handlebars Basics</a></li><li class='toc-level-1 '><a href="../../templates/built-in-helpers/">Built-in Helpers</a></li><li class='toc-level-1 '><a href="../../templates/conditionals/">Conditionals</a></li><li class='toc-level-1 '><a href="../../templates/displaying-a-list-of-items/">Displaying a List of Items</a></li><li class='toc-level-1 '><a href="../../templates/displaying-the-keys-in-an-object/">Displaying the Keys in an Object</a></li><li class='toc-level-1 '><a href="../../templates/binding-element-attributes/">Binding Element Attributes</a></li><li class='toc-level-1 '><a href="../../templates/links/">Links</a></li><li class='toc-level-1 '><a href="../../templates/actions/">Actions</a></li><li class='toc-level-1 '><a href="../../templates/input-helpers/">Input Helpers</a></li><li class='toc-level-1 '><a href="../../templates/development-helpers/">Development Helpers</a></li><li class='toc-level-1 '><a href="../../templates/writing-helpers/">Writing Helpers</a></li></ol></li><li class='toc-level-0 '><a href="#">Components</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../components/defining-a-component/">Defining a Component</a></li><li class='toc-level-1 '><a href="../../components/the-component-lifecycle/">The Component Lifecycle</a></li><li class='toc-level-1 '><a href="../../components/passing-properties-to-a-component/">Passing Properties to a Component</a></li><li class='toc-level-1 '><a href="../../components/wrapping-content-in-a-component/">Wrapping Content in a Component</a></li><li class='toc-level-1 '><a href="../../components/customizing-a-components-element/">Customizing a Component's Element</a></li><li class='toc-level-1 '><a href="../../components/block-params/">Using Block Params</a></li><li class='toc-level-1 '><a href="../../components/handling-events/">Handling Events</a></li><li class='toc-level-1 '><a href="../../components/triggering-changes-with-actions/">Triggering Changes with Actions</a></li></ol></li><li class='toc-level-0 '><a href="#">Controllers</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../controllers/">Introduction</a></li></ol></li><li class='toc-level-0 '><a href="#">Models</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../models/">Introduction</a></li><li class='toc-level-1 '><a href="../../models/defining-models/">Defining Models</a></li><li class='toc-level-1 '><a href="../../models/finding-records/">Finding Records</a></li><li class='toc-level-1 '><a href="../../models/creating-updating-and-deleting-records/">Creating, Updating and Deleting</a></li><li class='toc-level-1 '><a href="../../models/relationships/">Relationships</a></li><li class='toc-level-1 '><a href="../../models/pushing-records-into-the-store/">Pushing Records into the Store</a></li><li class='toc-level-1 '><a href="../../models/handling-metadata/">Handling Metadata</a></li><li class='toc-level-1 '><a href="../../models/customizing-adapters/">Customizing Adapters</a></li><li class='toc-level-1 '><a href="../../models/customizing-serializers/">Customizing Serializers</a></li></ol></li><li class='toc-level-0 '><a href="#">Application Concerns</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../applications/applications-and-instances/">Applications and Instances</a></li><li class='toc-level-1 '><a href="../../applications/dependency-injection/">Dependency Injection</a></li><li class='toc-level-1 '><a href="../../applications/initializers/">Initializers</a></li><li class='toc-level-1 '><a href="../../applications/services/">Services</a></li><li class='toc-level-1 '><a href="../../applications/run-loop/">The Run Loop</a></li></ol></li><li class='toc-level-0 '><a href="#">Testing</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../testing/">Introduction</a></li><li class='toc-level-1 '><a href="../../testing/acceptance/">Acceptance Tests</a></li><li class='toc-level-1 '><a href="../../testing/unit-testing-basics/">Unit Testing Basics</a></li><li class='toc-level-1 '><a href="../../testing/testing-components/">Testing Components</a></li><li class='toc-level-1 '><a href="../../testing/testing-controllers/">Testing Controllers</a></li><li class='toc-level-1 '><a href="../../testing/testing-routes/">Testing Routes</a></li><li class='toc-level-1 '><a href="../../testing/testing-models/">Testing Models</a></li></ol></li><li class='toc-level-0 '><a href="#">Ember Inspector</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../ember-inspector/installation/">Installing the Inspector</a></li><li class='toc-level-1 '><a href="../../ember-inspector/object-inspector/">Object Inspector</a></li><li class='toc-level-1 '><a href="../../ember-inspector/view-tree/">The View Tree</a></li><li class='toc-level-1 '><a href="../../ember-inspector/routes/">Inspecting Routes</a></li><li class='toc-level-1 '><a href="../../ember-inspector/data/">Data Tab</a></li><li class='toc-level-1 '><a href="../../ember-inspector/deprecations/">Tackling Deprecations</a></li><li class='toc-level-1 '><a href="../../ember-inspector/info/">Library Info</a></li><li class='toc-level-1 '><a href="../../ember-inspector/promises/">Debugging Promises</a></li><li class='toc-level-1 '><a href="../../ember-inspector/container/">Inspecting Objects via the Container</a></li><li class='toc-level-1 '><a href="../../ember-inspector/render-performance/">Rendering Performance</a></li><li class='toc-level-1 '><a href="../../ember-inspector/troubleshooting/">Troubleshooting</a></li></ol></li><li class='toc-level-0 '><a href="#">Addons and Dependencies</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../addons-and-dependencies/managing-dependencies/">Managing Dependencies</a></li></ol></li><li class='toc-level-0 '><a href="#">Configuring Ember.js</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../configuring-ember/configuring-your-app/">Configuring Your App</a></li><li class='toc-level-1 '><a href="../../configuring-ember/configuring-ember-cli/">Configuring Ember CLI</a></li><li class='toc-level-1 '><a href="../../configuring-ember/handling-deprecations/">Handling Deprecations</a></li><li class='toc-level-1 '><a href="../../configuring-ember/disabling-prototype-extensions/">Disabling Prototype Extensions</a></li><li class='toc-level-1 '><a href="../../configuring-ember/specifying-url-type/">Specifying the URL Type</a></li><li class='toc-level-1 '><a href="../../configuring-ember/embedding-applications/">Embedding Applications</a></li><li class='toc-level-1 '><a href="../../configuring-ember/feature-flags/">Feature Flags</a></li><li class='toc-level-1 '><a href="../../configuring-ember/debugging/">Debugging</a></li></ol></li><li class='toc-level-0 '><a href="#">Contributing to Ember.js</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../contributing/adding-new-features/">Adding New Features</a></li><li class='toc-level-1 '><a href="../../contributing/repositories/">Repositories</a></li></ol></li><li class='toc-level-0 '><a href="#">Glossary</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../glossary/web-development/">Web Development</a></li></ol></li></ol>
  </nav>

  <a class="back-to-top" href="#">&#11014; Back to Top</a>
</aside>


      <article class="chapter">
        <h1>
          Preventing and Retrying Transitions
          <a href="https://github.com/emberjs/guides/edit/master/source/localizable/routing/preventing-and-retrying-transitions.md"
             target="_blank" class="edit-page icon-pencil">Edit Page</a>
        </h1>
        <hr>

        <p>During a route transition, the Ember Router passes a transition
object to the various hooks on the routes involved in the transition.
Any hook that has access to this transition object has the ability
to immediately abort the transition by calling <code>transition.abort()</code>,
and if the transition object is stored, it can be re-attempted at a
later time by calling <code>transition.retry()</code>.</p>
<h3 class='anchorable-toc' id='toc_preventing-transitions-via-code-willtransition-code'>Preventing Transitions via <code>willTransition</code></h3>
<p>When a transition is attempted, whether via <code>{{link-to}}</code>, <code>transitionTo</code>,
or a URL change, a <code>willTransition</code> action is fired on the currently
active routes. This gives each active route, starting with the leaf-most
route, the opportunity to decide whether or not the transition should occur.</p>

<p>Imagine your app is in a route that&#39;s displaying a complex form for the user
to fill out and the user accidentally navigates backwards. Unless the
transition is prevented, the user might lose all of the progress they
made on the form, which can make for a pretty frustrating user experience.</p>

<p>Here&#39;s one way this situation could be handled:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">app/routes/form.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
</pre></td>
  <td class="code"><pre><span class="reserved">export</span> <span class="keyword">default</span> Ember.Route.extend({
  <span class="key">actions</span>: {
    willTransition(transition) {
      <span class="keyword">if</span> (<span class="local-variable">this</span>.controller.get(<span class="string"><span class="delimiter">'</span><span class="content">userHasEnteredData</span><span class="delimiter">'</span></span>) &amp;&amp;
          !confirm(<span class="string"><span class="delimiter">'</span><span class="content">Are you sure you want to abandon progress?</span><span class="delimiter">'</span></span>)) {
        transition.abort();
      } <span class="keyword">else</span> {
        <span class="comment">// Bubble the `willTransition` action so that</span>
        <span class="comment">// parent routes can decide whether or not to abort.</span>
        <span class="keyword">return</span> <span class="predefined-constant">true</span>;
      }
    }
  }
});
</pre></td>
</tr></table>
</div></div>
<p>When the user clicks on a <code>{{link-to}}</code> helper, or when the app initiates a
transition by using <code>transitionTo</code>, the transition will be aborted and the URL
will remain unchanged. However, if the browser back button is used to
navigate away from <code>route:form</code>, or if the user manually changes the URL, the
new URL will be navigated to before the <code>willTransition</code> action is
called. This will result in the browser displaying the new URL, even if
<code>willTransition</code> calls <code>transition.abort()</code>.</p>
<h3 class='anchorable-toc' id='toc_aborting-transitions-within-code-model-code-code-beforemodel-code-code-aftermodel-code'>Aborting Transitions Within <code>model</code>, <code>beforeModel</code>, <code>afterModel</code></h3>
<p>The <code>model</code>, <code>beforeModel</code>, and <code>afterModel</code> hooks described in
<a href="../asynchronous-routing">Asynchronous Routing</a>
each get called with a transition object. This makes it possible for
destination routes to abort attempted transitions.</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">app/routes/disco.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
</pre></td>
  <td class="code"><pre><span class="reserved">export</span> <span class="keyword">default</span> Ember.Route.extend({
  beforeModel(transition) {
    <span class="keyword">if</span> (<span class="keyword">new</span> Date() &gt; <span class="keyword">new</span> Date(<span class="string"><span class="delimiter">'</span><span class="content">January 1, 1980</span><span class="delimiter">'</span></span>)) {
      alert(<span class="string"><span class="delimiter">'</span><span class="content">Sorry, you need a time machine to enter this route.</span><span class="delimiter">'</span></span>);
      transition.abort();
    }
  }
});
</pre></td>
</tr></table>
</div></div><h3 class='anchorable-toc' id='toc_storing-and-retrying-a-transition'>Storing and Retrying a Transition</h3>
<p>Aborted transitions can be retried at a later time. A common use case
for this is having an authenticated route redirect the user to a login
page, and then redirecting them back to the authenticated route once
they&#39;ve logged in.</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">app/routes/some-authenticated.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
</pre></td>
  <td class="code"><pre><span class="reserved">export</span> <span class="keyword">default</span> Ember.Route.extend({
  beforeModel(transition) {
    <span class="keyword">if</span> (!<span class="local-variable">this</span>.controllerFor(<span class="string"><span class="delimiter">'</span><span class="content">auth</span><span class="delimiter">'</span></span>).get(<span class="string"><span class="delimiter">'</span><span class="content">userIsLoggedIn</span><span class="delimiter">'</span></span>)) {
      <span class="keyword">var</span> loginController = <span class="local-variable">this</span>.controllerFor(<span class="string"><span class="delimiter">'</span><span class="content">login</span><span class="delimiter">'</span></span>);
      loginController.set(<span class="string"><span class="delimiter">'</span><span class="content">previousTransition</span><span class="delimiter">'</span></span>, transition);
      <span class="local-variable">this</span>.transitionTo(<span class="string"><span class="delimiter">'</span><span class="content">login</span><span class="delimiter">'</span></span>);
    }
  }
});
</pre></td>
</tr></table>
</div></div><div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">app/controllers/login.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
</pre></td>
  <td class="code"><pre><span class="reserved">export</span> <span class="keyword">default</span> Ember.Controller.extend({
  <span class="key">actions</span>: {
    login() {
      <span class="comment">// Log the user in, then reattempt previous transition if it exists.</span>
      <span class="keyword">var</span> previousTransition = <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">previousTransition</span><span class="delimiter">'</span></span>);
      <span class="keyword">if</span> (previousTransition) {
        <span class="local-variable">this</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">previousTransition</span><span class="delimiter">'</span></span>, <span class="predefined-constant">null</span>);
        previousTransition.retry();
      } <span class="keyword">else</span> {
        <span class="comment">// Default back to homepage</span>
        <span class="local-variable">this</span>.transitionToRoute(<span class="string"><span class="delimiter">'</span><span class="content">index</span><span class="delimiter">'</span></span>);
      }
    }
  }
});
</pre></td>
</tr></table>
</div></div>


        
      <footer>
        <a class="previous-guide" href="../redirection/">Redirecting</a> <a class="next-guide" href="../loading-and-error-substates/">Loading / Error Substates</a>
      </footer>
      
      </article>
    </main>

    <div class="footer">
  <div class="container">
    <div class="footer-info">
      Copyright 2017
      <a href="http://tilde.io">Tilde Inc.</a>
      <br>
      <a href="http://emberjs.com/team">Core Team</a> |
      <a href="http://emberjs.com/sponsors">Sponsors</a>
      <br>
      <a href="http://emberjs.com/security">Security</a> |
      <a href="http://emberjs.com/legal">Legal</a> |
      <a href="http://emberjs.com/logos">Logos</a>
      <br>
      <a href="http://emberjs.com/guidelines">Community Guidelines</a>
    </div>

    <div class="footer-statement">
      Ember.js is free, open source and always will be.
    </div>

    <div class="footer-social">
      <a href="http://twitter.com/emberjs"
        title="Twitter">
        <i class="icon-twitter"></i>
      </a>
      <a href="https://github.com/emberjs/ember.js"
        title="GitHub">
        <i class="icon-github"></i>
      </a>
      <a href="https://plus.google.com/communities/106387049790387471205"
        title="Google+">
        <i class="icon-gplus"></i>
      </a>
    </div>
  </div>
</div>


    

    <script type="text/javascript">
      var _gaq = _gaq || [];
      var pluginUrl = '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
      _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
      _gaq.push(['_setAccount', 'UA-27675533-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>
</html>
