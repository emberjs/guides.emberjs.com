<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="theme-color" content="#e46652">

    <title>Ember.js - Testing: Testing Components</title>
    <meta property="st:title" content="Testing: Testing Components" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="../../images/favicon.png" rel="icon" type="image/png" />
    <!--[if lte IE 7 ]><link href="../../stylesheets/fonts/fontello-ie7.css" rel="stylesheet" /><![endif]-->
    <link href="../../stylesheets/application.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600" rel="stylesheet">
    
    <!-- This TypeKit account is managed by @wifelette. Contact her with any issues. -->
    <script src="https://use.typekit.net/stz3kpn.js"></script>
    <script>try{Typekit.load({ async: true });}catch(e){}</script>

    <link href="/blog/feed.xml" rel="alternate" type="application/atom+xml" title="Ember.js - Blog" />
    
  </head>

  <body class="guides testing testing_testing-components testing_testing-components_index">

    <!--[if lt IE 9]>
      <script src="../../javascripts/common-old-ie.js"></script>
    <![endif]-->
    <!--[if gte IE 9]><!-->
      <script src="../../javascripts/common-modern.js"></script>
    <!--<![endif]-->

    <header>
<nav class="navbar navbar-inverse">
 <div class="container">
  <div class="navbar-header">
   <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar-collapse" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
   <a class="navbar-brand" href="http://emberjs.com"><img src="https://glimmer-styleguide.global.ssl.fastly.net/glimmer-styleguide/master/images/ember-logo.svg" alt="home" /></a>
  </div>
  <div class="collapse navbar-collapse" id="navbar-collapse">
   <ul class="nav navbar-nav">
    <li class="dropdown">
     <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Docs <span class="caret"></span></a>
     <ul class="dropdown-menu">
      <li><a href="http://emberjs.com/guides">Guides</a></li>
      <li><a href="http://emberjs.com/api">API Reference</a></li>
      <li role="separator" class="divider"></li>
      <li><a href="http://emberjs.com/learn">Learn Ember</a></li>
     </ul>
    </li>
    <li class="dropdown">
     <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Releases <span class="caret"></span></a>
     <ul class="dropdown-menu">
      <li><a href="http://emberjs.com/builds">Channels</a></li>
      <li><a href="http://emberjs.com/builds/release">-- Stable</a></li>
      <li><a href="http://emberjs.com/builds/beta">-- Beta</a></li>
      <li><a href="http://emberjs.com/builds/canary">-- Canary</a></li>
      <li role="separator" class="divider"></li>
      <li><a href="http://emberjs.com/deprecations">Deprecations</a></li>
      <li><a href="http://emberjs.com/statusboard">Status Board</a></li>
     </ul>
    </li>
    <li><a href="http://emberjs.com/blog">Blog</a></li>
    <li class="dropdown">
     <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">Community <span class="caret"></span></a>
     <ul class="dropdown-menu">
      <li><a href="http://emberjs.com/community">The Ember Community</a></li>
       <li><a href="http://emberjs.com/guidelines">Guidelines</a></li>
       <li><a href="http://github.com/emberjs/">Contribute (Github)</a></li>
       <li role="separator" class="divider"></li>
       <li><a href="http://emberjs.com/community/meetups">Meetups</a></li>
       <li><a href="http://jobs.emberjs.com/">Job Board</a></li>
       <li role="separator" class="divider"></li>
       <li><a href="http://emberconf.com/">Ember Conf</a></li>
     </ul>
     </li>
     <li class="dropdown">
      <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-haspopup="true" aria-expanded="false">About<span class="caret"></span></a>
      <ul class="dropdown-menu">
       <li><a href="http://emberjs.com/team">The Team</a></li>
       <li role="separator" class="divider"></li>
       <li><a href="http://emberjs.com/logos">Logos</a></li>
       <li><a href="http://emberjs.com/mascots">Mascots</a></li>
       <li role="separator" class="divider"></li>
       <li><a href="http://emberjs.com/ember-users">Who Uses Ember</a></li>
       <li><a href="http://emberjs.com/sponsors">Sponsors</a></li>
       <li role="separator" class="divider"></li>
       <li><a href="http://emberjs.com/legal">Legal</a></li>
       <li><a href="http://emberjs.com/security">Security</a></li>
      </ul>
     </li>
   </ul>
   <form class="navbar-form navbar-right searchbox">
    <div class="input-group">
      <label for="search-input" class="control-label sr-only">Search</label>
        <input type="text"
        class="form-control search input ds-input"
        placeholder="Search..."
        id="search-input"
        role="combobox"
        aria-expanded="false"
        aria-owns="algolia-autocomplete-listbox-0"
        autocorrect="off"
        autocapitalize="none"
        spellcheck="false"
        />
        <span></span>
    </div>
   </form>
  </div>
  <!-- /.navbar-collapse -->
 </div>
 <!-- /.container-fluid -->
</nav>
</header>


    

    <main class="container">

      <aside class="sidebar">
  <label for="version-select" class="visually-hidden">Guides version</label>
  <select class="version-select" id="version-select" style="width: 100%"></select>

  <input id="toc-toggle" class="toc-toggle visually-hidden" type="checkbox" />
  <label for="toc-toggle">Table of Contents <span class="visually-hidden">toggle</span></label>

  <nav class='toc-container' aria-label='table of contents'><ol class='toc-level-0 selected'><li class='toc-level-0 '><a href="#">Getting Started</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../getting-started/quick-start/">Quick Start</a></li><li class='toc-level-1 '><a href="../../getting-started/">Installing Ember</a></li><li class='toc-level-1 '><a href="../../getting-started/core-concepts/">Core Concepts</a></li><li class='toc-level-1 '><a href="../../getting-started/js-primer/">JavaScript Primer</a></li></ol></li><li class='toc-level-0 '><a href="#">Tutorial</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../tutorial/ember-cli/">Creating Your App</a></li><li class='toc-level-1 '><a href="../../tutorial/acceptance-test/">Planning Your App</a></li><li class='toc-level-1 '><a href="../../tutorial/routes-and-templates/">Routes and Templates</a></li><li class='toc-level-1 '><a href="../../tutorial/model-hook/">The Model Hook</a></li><li class='toc-level-1 '><a href="../../tutorial/installing-addons/">Installing Addons</a></li><li class='toc-level-1 '><a href="../../tutorial/simple-component/">Building a Simple Component</a></li><li class='toc-level-1 '><a href="../../tutorial/hbs-helper/">Creating a Handlebars Helper</a></li><li class='toc-level-1 '><a href="../../tutorial/ember-data/">Using Ember Data</a></li><li class='toc-level-1 '><a href="../../tutorial/autocomplete-component/">Building a Complex Component</a></li><li class='toc-level-1 '><a href="../../tutorial/service/">Services and Utilities</a></li><li class='toc-level-1 '><a href="../../tutorial/subroutes/">Adding Nested Routes</a></li><li class='toc-level-1 '><a href="../../tutorial/deploying/">Deploying</a></li></ol></li><li class='toc-level-0 '><a href="#">The Object Model</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../object-model/">Objects in Ember</a></li><li class='toc-level-1 '><a href="../../object-model/classes-and-instances/">Classes and Instances</a></li><li class='toc-level-1 '><a href="../../object-model/reopening-classes-and-instances/">Reopening Classes and Instances</a></li><li class='toc-level-1 '><a href="../../object-model/computed-properties/">Computed Properties</a></li><li class='toc-level-1 '><a href="../../object-model/computed-properties-and-aggregate-data/">Computed Properties and Aggregate Data</a></li><li class='toc-level-1 '><a href="../../object-model/observers/">Observers</a></li><li class='toc-level-1 '><a href="../../object-model/bindings/">Bindings</a></li><li class='toc-level-1 '><a href="../../object-model/enumerables/">Enumerables</a></li></ol></li><li class='toc-level-0 '><a href="#">Routing</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../routing/">Introduction</a></li><li class='toc-level-1 '><a href="../../routing/defining-your-routes/">Defining Your Routes</a></li><li class='toc-level-1 '><a href="../../routing/specifying-a-routes-model/">Specifying a Route's Model</a></li><li class='toc-level-1 '><a href="../../routing/rendering-a-template/">Rendering a Template</a></li><li class='toc-level-1 '><a href="../../routing/redirection/">Redirecting</a></li><li class='toc-level-1 '><a href="../../routing/preventing-and-retrying-transitions/">Preventing and Retrying Transitions</a></li><li class='toc-level-1 '><a href="../../routing/loading-and-error-substates/">Loading / Error Substates</a></li><li class='toc-level-1 '><a href="../../routing/query-params/">Query Parameters</a></li><li class='toc-level-1 '><a href="../../routing/asynchronous-routing/">Asynchronous Routing</a></li></ol></li><li class='toc-level-0 '><a href="#">Templates</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../templates/handlebars-basics/">Handlebars Basics</a></li><li class='toc-level-1 '><a href="../../templates/built-in-helpers/">Built-in Helpers</a></li><li class='toc-level-1 '><a href="../../templates/conditionals/">Conditionals</a></li><li class='toc-level-1 '><a href="../../templates/displaying-a-list-of-items/">Displaying a List of Items</a></li><li class='toc-level-1 '><a href="../../templates/displaying-the-keys-in-an-object/">Displaying the Keys in an Object</a></li><li class='toc-level-1 '><a href="../../templates/binding-element-attributes/">Binding Element Attributes</a></li><li class='toc-level-1 '><a href="../../templates/links/">Links</a></li><li class='toc-level-1 '><a href="../../templates/actions/">Actions</a></li><li class='toc-level-1 '><a href="../../templates/input-helpers/">Input Helpers</a></li><li class='toc-level-1 '><a href="../../templates/development-helpers/">Development Helpers</a></li><li class='toc-level-1 '><a href="../../templates/writing-helpers/">Writing Helpers</a></li></ol></li><li class='toc-level-0 '><a href="#">Components</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../components/defining-a-component/">Defining a Component</a></li><li class='toc-level-1 '><a href="../../components/the-component-lifecycle/">The Component Lifecycle</a></li><li class='toc-level-1 '><a href="../../components/passing-properties-to-a-component/">Passing Properties to a Component</a></li><li class='toc-level-1 '><a href="../../components/wrapping-content-in-a-component/">Wrapping Content in a Component</a></li><li class='toc-level-1 '><a href="../../components/customizing-a-components-element/">Customizing a Component's Element</a></li><li class='toc-level-1 '><a href="../../components/block-params/">Using Block Params</a></li><li class='toc-level-1 '><a href="../../components/handling-events/">Handling Events</a></li><li class='toc-level-1 '><a href="../../components/triggering-changes-with-actions/">Triggering Changes with Actions</a></li></ol></li><li class='toc-level-0 '><a href="#">Controllers</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../controllers/">Introduction</a></li></ol></li><li class='toc-level-0 '><a href="#">Models</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../models/">Introduction</a></li><li class='toc-level-1 '><a href="../../models/defining-models/">Defining Models</a></li><li class='toc-level-1 '><a href="../../models/finding-records/">Finding Records</a></li><li class='toc-level-1 '><a href="../../models/creating-updating-and-deleting-records/">Creating, Updating and Deleting</a></li><li class='toc-level-1 '><a href="../../models/relationships/">Relationships</a></li><li class='toc-level-1 '><a href="../../models/pushing-records-into-the-store/">Pushing Records into the Store</a></li><li class='toc-level-1 '><a href="../../models/handling-metadata/">Handling Metadata</a></li><li class='toc-level-1 '><a href="../../models/customizing-adapters/">Customizing Adapters</a></li><li class='toc-level-1 '><a href="../../models/customizing-serializers/">Customizing Serializers</a></li></ol></li><li class='toc-level-0 '><a href="#">Application Concerns</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../applications/applications-and-instances/">Applications and Instances</a></li><li class='toc-level-1 '><a href="../../applications/dependency-injection/">Dependency Injection</a></li><li class='toc-level-1 '><a href="../../applications/initializers/">Initializers</a></li><li class='toc-level-1 '><a href="../../applications/services/">Services</a></li><li class='toc-level-1 '><a href="../../applications/run-loop/">The Run Loop</a></li></ol></li><li class='toc-level-0 selected'><a href="#">Testing</a><ol class='toc-level-1 selected'><li class='toc-level-1 '><a href="../">Introduction</a></li><li class='toc-level-1 '><a href="../acceptance/">Application Tests</a></li><li class='toc-level-1 '><a href="../unit-testing-basics/">Testing Basics</a></li><li class='toc-level-1 selected'><a href="./">Testing Components</a></li><li class='toc-level-1 '><a href="../testing-helpers/">Testing Helpers</a></li><li class='toc-level-1 '><a href="../testing-controllers/">Testing Controllers</a></li><li class='toc-level-1 '><a href="../testing-routes/">Testing Routes</a></li><li class='toc-level-1 '><a href="../testing-models/">Testing Models</a></li></ol></li><li class='toc-level-0 '><a href="#">Ember Inspector</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../ember-inspector/">Introduction</a></li><li class='toc-level-1 '><a href="../../ember-inspector/installation/">Installing the Inspector</a></li><li class='toc-level-1 '><a href="../../ember-inspector/object-inspector/">Object Inspector</a></li><li class='toc-level-1 '><a href="../../ember-inspector/view-tree/">The View Tree</a></li><li class='toc-level-1 '><a href="../../ember-inspector/routes/">Inspecting Routes</a></li><li class='toc-level-1 '><a href="../../ember-inspector/data/">Data Tab</a></li><li class='toc-level-1 '><a href="../../ember-inspector/deprecations/">Tackling Deprecations</a></li><li class='toc-level-1 '><a href="../../ember-inspector/info/">Library Info</a></li><li class='toc-level-1 '><a href="../../ember-inspector/promises/">Debugging Promises</a></li><li class='toc-level-1 '><a href="../../ember-inspector/container/">Inspecting Objects via the Container</a></li><li class='toc-level-1 '><a href="../../ember-inspector/render-performance/">Rendering Performance</a></li><li class='toc-level-1 '><a href="../../ember-inspector/troubleshooting/">Troubleshooting</a></li></ol></li><li class='toc-level-0 '><a href="#">Addons and Dependencies</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../addons-and-dependencies/managing-dependencies/">Managing Dependencies</a></li></ol></li><li class='toc-level-0 '><a href="#">Configuring Ember.js</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../configuring-ember/configuring-your-app/">Configuring Your App</a></li><li class='toc-level-1 '><a href="../../configuring-ember/configuring-ember-cli/">Configuring Ember CLI</a></li><li class='toc-level-1 '><a href="../../configuring-ember/handling-deprecations/">Handling Deprecations</a></li><li class='toc-level-1 '><a href="../../configuring-ember/disabling-prototype-extensions/">Disabling Prototype Extensions</a></li><li class='toc-level-1 '><a href="../../configuring-ember/specifying-url-type/">Specifying the URL Type</a></li><li class='toc-level-1 '><a href="../../configuring-ember/embedding-applications/">Embedding Applications</a></li><li class='toc-level-1 '><a href="../../configuring-ember/feature-flags/">Feature Flags</a></li><li class='toc-level-1 '><a href="../../configuring-ember/build-targets/">Build targets</a></li><li class='toc-level-1 '><a href="../../configuring-ember/debugging/">Debugging</a></li></ol></li><li class='toc-level-0 '><a href="#">Contributing to Ember.js</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../contributing/adding-new-features/">Adding New Features</a></li><li class='toc-level-1 '><a href="../../contributing/repositories/">Repositories</a></li></ol></li><li class='toc-level-0 '><a href="#">Glossary</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../glossary/web-development/">Web Development</a></li></ol></li></ol></nav>

  <a class="back-to-top" href="#">&#11014; Back to Top</a>
</aside>


      <article class="chapter">
        <h1>
          Testing Components
          <a href="https://github.com/emberjs/guides/edit/master/source/testing/testing-components.md"
             target="_blank" class="edit-page icon-pencil">Edit Page</a>
        </h1>
        <hr>

        <p>Components can be tested easily with a rendering test. Let&#39;s see how this plays out in a specific example:</p>

<p>Let&#39;s assume we have a component with a <code>style</code> property that is updated
whenever the value of the <code>name</code> property changes. The <code>style</code> attribute of the
component is bound to its <code>style</code> property.</p>

<blockquote>
<p>You can follow along by generating your own component with <code>ember generate
component pretty-color</code>.</p>
</blockquote>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">app/components/pretty-color.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
</pre></td>
  <td class="code"><pre><span class="reserved">import</span> Component from <span class="string"><span class="delimiter">'</span><span class="content">@ember/component</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { computed } from <span class="string"><span class="delimiter">'</span><span class="content">@ember/object</span><span class="delimiter">'</span></span>;

<span class="reserved">export</span> <span class="keyword">default</span> Component.extend({
  <span class="key">attributeBindings</span>: [<span class="string"><span class="delimiter">'</span><span class="content">style</span><span class="delimiter">'</span></span>],

  <span class="key">style</span>: computed(<span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>, <span class="keyword">function</span>() {
    const name = <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">name</span><span class="delimiter">'</span></span>);
    <span class="keyword">return</span> <span class="error">`</span>color: <span class="predefined">$</span>{name}<span class="error">`</span>;
  })
});
</pre></td>
</tr></table>
</div></div><div class="highlight handlebars "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">app/templates/components/pretty-color.hbs</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>Pretty Color: <span class="inline"><span class="inline-delimiter">{{</span><span class="attribute-name">name</span><span class="inline-delimiter">}}</span></span>
</pre></td>
</tr></table>
</div></div>
<p>The <code>module</code> from QUnit will scope your tests into groups of tests which can be
configured and run independently. Make sure to call the <code>setupRenderingTest</code> function together with the <code>hooks</code> parameter
first in your new module. This will do all the setup necessary for testing your component for you,
including setting up a way to access the rendered DOM of your component later on in the test
and it will clean up after you once your tests in this module are finished.</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">tests/integration/components/pretty-color-test.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
</pre></td>
  <td class="code"><pre><span class="reserved">import</span> { module } from <span class="string"><span class="delimiter">'</span><span class="content">qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { setupRenderingTest } from <span class="string"><span class="delimiter">'</span><span class="content">ember-qunit</span><span class="delimiter">'</span></span>;

module(<span class="string"><span class="delimiter">'</span><span class="content">Integration | Component | pretty color</span><span class="delimiter">'</span></span>, <span class="keyword">function</span>(hooks) {
  setupRenderingTest(hooks);

});
</pre></td>
</tr></table>
</div></div>
<p>Inside of your <code>module</code> and after setting up the test, we can now start to create our first test case. Here we can use the <code>QUnit.test</code> helper and we can
give it a descriptive name:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">tests/integration/components/pretty-color-test.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
</pre></td>
  <td class="code"><pre><span class="reserved">import</span> { module, test } from <span class="string"><span class="delimiter">'</span><span class="content">qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { setupRenderingTest } from <span class="string"><span class="delimiter">'</span><span class="content">ember-qunit</span><span class="delimiter">'</span></span>;

module(<span class="string"><span class="delimiter">'</span><span class="content">Integration | Component | pretty color</span><span class="delimiter">'</span></span>, <span class="keyword">function</span>(hooks) {
  setupRenderingTest(hooks);

  test(<span class="string"><span class="delimiter">'</span><span class="content">should change colors</span><span class="delimiter">'</span></span>, async <span class="keyword">function</span>(assert) {


  });
});
</pre></td>
</tr></table>
</div></div>
<p>Also note how the callback function passed to the test helper is marked with the keyword <code>async</code>. The <a href="https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Operators/await">ECMAScript 2017 feature async/await</a> allows us to write asynchronous code in an easy-to-read, seemingly synchronous manner. We can better see what this means, once we start writing out our first test case:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">tests/integration/components/pretty-color-test.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
<strong>20</strong>
</pre></td>
  <td class="code"><pre><span class="reserved">import</span> { module, test } from <span class="string"><span class="delimiter">'</span><span class="content">qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { setupRenderingTest } from <span class="string"><span class="delimiter">'</span><span class="content">ember-qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { render } from <span class="string"><span class="delimiter">'</span><span class="content">@ember/test-helpers</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> hbs from <span class="string"><span class="delimiter">'</span><span class="content">htmlbars-inline-precompile</span><span class="delimiter">'</span></span>;

module(<span class="string"><span class="delimiter">'</span><span class="content">Integration | Component | pretty color</span><span class="delimiter">'</span></span>, <span class="keyword">function</span>(hooks) {
  setupRenderingTest(hooks);

  test(<span class="string"><span class="delimiter">'</span><span class="content">should change colors</span><span class="delimiter">'</span></span>, async <span class="keyword">function</span>(assert) {
    assert.expect(<span class="integer">1</span>);

    <span class="comment">// set the outer context to red</span>
    <span class="local-variable">this</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">colorValue</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">red</span><span class="delimiter">'</span></span>);

    await render(hbs<span class="error">`</span>{{pretty-color name=colorValue}}<span class="error">`</span>);

    assert.equal(<span class="local-variable">this</span>.element.querySelector(<span class="string"><span class="delimiter">'</span><span class="content">div</span><span class="delimiter">'</span></span>).getAttribute(<span class="string"><span class="delimiter">'</span><span class="content">style</span><span class="delimiter">'</span></span>), <span class="string"><span class="delimiter">'</span><span class="content">color: red</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">starts as red</span><span class="delimiter">'</span></span>);
  });
});

</pre></td>
</tr></table>
</div></div>
<p>Each test can use the <code>render()</code>
function imported from the <code>@ember/test-helpers</code> package to create a new instance of the component by declaring
the component in template syntax, as we would in our application.
Also notice, the keyword <code>await</code> in front of the call to <code>render</code>. It allows the test which we marked as <code>async</code> earlier to wait for any asynchronous behaviour to complete before any code which is written below that will be executed.
In this case our first assertion will correctly execute after the component has fully rendered.</p>

<p>Next we can test that changing the component&#39;s <code>name</code> property updates the
component&#39;s <code>style</code> attribute and is reflected in the rendered HTML:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">tests/integration/components/pretty-color-test.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
<strong>20</strong>
21
22
23
</pre></td>
  <td class="code"><pre><span class="reserved">import</span> { module, test } from <span class="string"><span class="delimiter">'</span><span class="content">qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { setupRenderingTest } from <span class="string"><span class="delimiter">'</span><span class="content">ember-qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { render } from <span class="string"><span class="delimiter">'</span><span class="content">@ember/test-helpers</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> hbs from <span class="string"><span class="delimiter">'</span><span class="content">htmlbars-inline-precompile</span><span class="delimiter">'</span></span>;

module(<span class="string"><span class="delimiter">'</span><span class="content">Integration | Component | pretty color</span><span class="delimiter">'</span></span>, <span class="keyword">function</span>(hooks) {
  setupRenderingTest(hooks);

  test(<span class="string"><span class="delimiter">'</span><span class="content">it renders</span><span class="delimiter">'</span></span>, async <span class="keyword">function</span>(assert) {
    assert.expect(<span class="integer">2</span>);

    <span class="comment">// set the outer context to red</span>
    <span class="local-variable">this</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">colorValue</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">red</span><span class="delimiter">'</span></span>);

    await render(hbs<span class="error">`</span>{{pretty-color name=colorValue}}<span class="error">`</span>);

    assert.equal(<span class="local-variable">this</span>.element.querySelector(<span class="string"><span class="delimiter">'</span><span class="content">div</span><span class="delimiter">'</span></span>).getAttribute(<span class="string"><span class="delimiter">'</span><span class="content">style</span><span class="delimiter">'</span></span>), <span class="string"><span class="delimiter">'</span><span class="content">color: red</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">starts as red</span><span class="delimiter">'</span></span>);

    <span class="local-variable">this</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">colorValue</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">blue</span><span class="delimiter">'</span></span>);

    assert.equal(<span class="local-variable">this</span>.element.querySelector(<span class="string"><span class="delimiter">'</span><span class="content">div</span><span class="delimiter">'</span></span>).getAttribute(<span class="string"><span class="delimiter">'</span><span class="content">style</span><span class="delimiter">'</span></span>), <span class="string"><span class="delimiter">'</span><span class="content">color: blue</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">updates to blue</span><span class="delimiter">'</span></span>);  });
});

</pre></td>
</tr></table>
</div></div>
<p>We might also test this component to ensure that the content of its template is
being rendered properly:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">tests/integration/components/pretty-color-test.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
<strong>20</strong>
21
22
23
</pre></td>
  <td class="code"><pre><span class="reserved">import</span> { module, test } from <span class="string"><span class="delimiter">'</span><span class="content">qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { setupRenderingTest } from <span class="string"><span class="delimiter">'</span><span class="content">ember-qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { render } from <span class="string"><span class="delimiter">'</span><span class="content">@ember/test-helpers</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> hbs from <span class="string"><span class="delimiter">'</span><span class="content">htmlbars-inline-precompile</span><span class="delimiter">'</span></span>;

module(<span class="string"><span class="delimiter">'</span><span class="content">Integration | Component | pretty color</span><span class="delimiter">'</span></span>, <span class="keyword">function</span>(hooks) {
  setupRenderingTest(hooks);

  test(<span class="string"><span class="delimiter">'</span><span class="content">it renders</span><span class="delimiter">'</span></span>, async <span class="keyword">function</span>(assert) {
    assert.expect(<span class="integer">2</span>);

    <span class="local-variable">this</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">colorValue</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">orange</span><span class="delimiter">'</span></span>);

    await render(hbs<span class="error">`</span>{{pretty-color name=colorValue}}<span class="error">`</span>);

    assert.equal(<span class="local-variable">this</span>.element.textContent.trim(), <span class="string"><span class="delimiter">'</span><span class="content">Pretty Color: orange</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">text starts as orange</span><span class="delimiter">'</span></span>);

    <span class="local-variable">this</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">colorValue</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">blue</span><span class="delimiter">'</span></span>);

    assert.equal(<span class="local-variable">this</span>.element.textContent.trim(), <span class="string"><span class="delimiter">'</span><span class="content">Pretty Color: green</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">text switches to green</span><span class="delimiter">'</span></span>);
  });
});

</pre></td>
</tr></table>
</div></div><h3 class='anchorable-toc' id='toc_testing-user-interaction'>Testing User Interaction</h3>
<p>Components are a great way to create powerful, interactive, and self-contained
custom HTML elements. It is important to test the component&#39;s methods <em>and</em> the
user&#39;s interaction with the component.</p>

<p>Imagine you have the following component that changes its title when a button is
clicked on:</p>

<blockquote>
<p>You can follow along by generating your own component with <code>ember generate
component magic-title</code>.</p>
</blockquote>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">app/components/magic-title.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
</pre></td>
  <td class="code"><pre><span class="reserved">import</span> Component from <span class="string"><span class="delimiter">'</span><span class="content">@ember/component</span><span class="delimiter">'</span></span>;

<span class="reserved">export</span> <span class="keyword">default</span> Component.extend({
  <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Hello World</span><span class="delimiter">'</span></span>,

  <span class="key">actions</span>: {
    updateTitle() {
      <span class="local-variable">this</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">title</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">This is Magic</span><span class="delimiter">'</span></span>);
    }
  }
});
</pre></td>
</tr></table>
</div></div><div class="highlight handlebars "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">app/templates/components/magic-title.hbs</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre><span class="tag">&lt;h2&gt;</span><span class="inline"><span class="inline-delimiter">{{</span><span class="attribute-name">title</span><span class="inline-delimiter">}}</span></span><span class="tag">&lt;/h2&gt;</span>

<span class="tag">&lt;button</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">title-button</span><span class="delimiter">&quot;</span></span> <span class="inline"><span class="inline-delimiter">{{</span><span class="attribute-name">action</span> <span class="error">&quot;</span><span class="attribute-name">updateTitle</span><span class="error">&quot;</span><span class="inline-delimiter">}}</span></span><span class="tag">&gt;</span>
  Update Title
<span class="tag">&lt;/button&gt;</span>
</pre></td>
</tr></table>
</div></div>
<p>And our test might look like this:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">tests/integration/components/magic-title-test.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
<strong>20</strong>
21
</pre></td>
  <td class="code"><pre><span class="reserved">import</span> { module, test } from <span class="string"><span class="delimiter">'</span><span class="content">qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { setupRenderingTest } from <span class="string"><span class="delimiter">'</span><span class="content">ember-qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { click, render } from <span class="string"><span class="delimiter">'</span><span class="content">@ember/test-helpers</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> hbs from <span class="string"><span class="delimiter">'</span><span class="content">htmlbars-inline-precompile</span><span class="delimiter">'</span></span>;

module(<span class="string"><span class="delimiter">'</span><span class="content">Integration | Component | magic title</span><span class="delimiter">'</span></span>, <span class="keyword">function</span>(hooks) {
  setupRenderingTest(hooks);

  test(<span class="string"><span class="delimiter">'</span><span class="content">should update title on button click</span><span class="delimiter">'</span></span>, async <span class="keyword">function</span>(assert) {
    assert.expect(<span class="integer">2</span>);

    await render(hbs<span class="error">`</span>{{magic-title}}<span class="error">`</span>);

    assert.equal(<span class="local-variable">this</span>.element.querySelector(<span class="string"><span class="delimiter">'</span><span class="content">h2</span><span class="delimiter">'</span></span>).textContent.trim(), <span class="string"><span class="delimiter">'</span><span class="content">Hello World</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">initial text is hello world</span><span class="delimiter">'</span></span>);

    <span class="comment">//Click on the button</span>
    await click(<span class="string"><span class="delimiter">'</span><span class="content">.title-button</span><span class="delimiter">'</span></span>);

    assert.equal(<span class="local-variable">this</span>.element.querySelector(<span class="string"><span class="delimiter">'</span><span class="content">h2</span><span class="delimiter">'</span></span>).textContent.trim(), <span class="string"><span class="delimiter">'</span><span class="content">This is Magic</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">title changes after click</span><span class="delimiter">'</span></span>);
  });
});
</pre></td>
</tr></table>
</div></div>
<p>Note how we make use of the <code>click</code> helper from <a href="https://github.com/emberjs/ember-test-helpers"><code>ember-test-helpers</code></a> to interact with the
component DOM to trigger the <code>updateTitle</code> action.
You can find many other helpful helpers for simulating user interaction in rendering tests in the <a href="https://github.com/emberjs/ember-test-helpers/blob/master/API.md">API documentation of ember-test-helpers</a>.</p>
<h3 class='anchorable-toc' id='toc_testing-actions'>Testing Actions</h3>
<p>Components starting in Ember 2 utilize closure actions. Closure actions allow components
to directly invoke functions provided by outer components.</p>

<p>For example, imagine you have a comment form component that invokes a
<code>submitComment</code> action when the form is submitted, passing along the form&#39;s data:</p>

<blockquote>
<p>You can follow along by generating your own component with <code>ember generate
component comment-form</code>.</p>
</blockquote>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">app/components/comment-form.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
</pre></td>
  <td class="code"><pre><span class="reserved">import</span> Component from <span class="string"><span class="delimiter">'</span><span class="content">@ember/component</span><span class="delimiter">'</span></span>;

<span class="reserved">export</span> <span class="keyword">default</span> Component.extend({
  <span class="key">comment</span>: <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>,

  <span class="key">actions</span>: {
    submitComment() {
      <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">submitComment</span><span class="delimiter">'</span></span>)({ <span class="key">comment</span>: <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">comment</span><span class="delimiter">'</span></span>) });
    }
  }
});
</pre></td>
</tr></table>
</div></div><div class="highlight handlebars "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">app/templates/components/comment-form.hbs</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
</pre></td>
  <td class="code"><pre><span class="tag">&lt;form</span> <span class="inline"><span class="inline-delimiter">{{</span><span class="attribute-name">action</span> <span class="error">&quot;</span><span class="attribute-name">submitComment</span><span class="error">&quot;</span> <span class="attribute-name">on</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">submit</span><span class="delimiter">&quot;</span></span><span class="inline-delimiter">}}</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;label&gt;</span>Comment:<span class="tag">&lt;/label&gt;</span>
  <span class="inline"><span class="inline-delimiter">{{</span><span class="attribute-name">textarea</span> <span class="attribute-name">value</span>=<span class="attribute-value">comment</span><span class="inline-delimiter">}}</span></span>

  <span class="tag">&lt;input</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">comment-input</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">type</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">submit</span><span class="delimiter">&quot;</span></span> <span class="attribute-name">value</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Submit</span><span class="delimiter">&quot;</span></span><span class="tag">/&gt;</span>
<span class="tag">&lt;/form&gt;</span>
</pre></td>
</tr></table>
</div></div>
<p>Here&#39;s an example test that asserts that the specified <code>externalAction</code> function
is invoked when the component&#39;s internal <code>submitComment</code> action is triggered by making use
of a test double (dummy function).
<code>assert.expect(1)</code> at the top of the test makes sure that the assertion inside the
external action is called:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">tests/integration/components/comment-form-test.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
<strong>20</strong>
21
22
23
24
25
26
</pre></td>
  <td class="code"><pre><span class="reserved">import</span> { module, test } from <span class="string"><span class="delimiter">'</span><span class="content">qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { setupRenderingTest } from <span class="string"><span class="delimiter">'</span><span class="content">ember-qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { fillIn, render } from <span class="string"><span class="delimiter">'</span><span class="content">@ember/test-helpers</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> hbs from <span class="string"><span class="delimiter">'</span><span class="content">htmlbars-inline-precompile</span><span class="delimiter">'</span></span>;

module(<span class="string"><span class="delimiter">'</span><span class="content">Integration | Component | comment form</span><span class="delimiter">'</span></span>, <span class="keyword">function</span>(hooks) {
  setupRenderingTest(hooks);

  test(<span class="string"><span class="delimiter">'</span><span class="content">should trigger external action on form submit</span><span class="delimiter">'</span></span>, async <span class="keyword">function</span>(assert) {
    assert.expect(<span class="integer">1</span>);

    <span class="comment">// test double for the external action</span>
    <span class="local-variable">this</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">externalAction</span><span class="delimiter">'</span></span>, (actual) =&gt; {
      let expected = { <span class="key">comment</span>: <span class="string"><span class="delimiter">'</span><span class="content">You are not a wizard!</span><span class="delimiter">'</span></span> };
      assert.deepEqual(actual, expected, <span class="string"><span class="delimiter">'</span><span class="content">submitted value is passed to external action</span><span class="delimiter">'</span></span>);
    });

    await render(hbs<span class="error">`</span>{{comment-form submitComment=(action externalAction)}}<span class="error">`</span>);

    <span class="comment">// fill out the form and force an onchange</span>
    await fillIn(<span class="string"><span class="delimiter">'</span><span class="content">textarea</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">You are not a wizard!</span><span class="delimiter">'</span></span>);

    <span class="comment">// click the button to submit the form</span>
    await click(<span class="string"><span class="delimiter">'</span><span class="content">.comment-input</span><span class="delimiter">'</span></span>);
  });
});
</pre></td>
</tr></table>
</div></div><h3 class='anchorable-toc' id='toc_stubbing-services'>Stubbing Services</h3>
<p>In cases where components have dependencies on Ember services, it is possible to stub these
dependencies for rendering tests. You stub Ember services by using the built-in <code>register()</code>
function to register your stub service in place of the default.</p>

<p>Imagine you have the following component that uses a location service to display the city
and country of your current location:</p>

<blockquote>
<p>You can follow along by generating your own component with <code>ember generate
component location-indicator</code>.</p>
</blockquote>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">app/components/location-indicator.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
</pre></td>
  <td class="code"><pre><span class="reserved">import</span> Component from <span class="string"><span class="delimiter">'</span><span class="content">@ember/component</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { computed } from <span class="string"><span class="delimiter">'</span><span class="content">@ember/object</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { inject as service } from <span class="string"><span class="delimiter">'</span><span class="content">@ember/service</span><span class="delimiter">'</span></span>;

<span class="reserved">export</span> <span class="keyword">default</span> Component.extend({
  <span class="key">locationService</span>: service(<span class="string"><span class="delimiter">'</span><span class="content">location-service</span><span class="delimiter">'</span></span>),

  <span class="comment">// when the coordinates change, call the location service to get the current city and country</span>
  <span class="key">city</span>: computed(<span class="string"><span class="delimiter">'</span><span class="content">locationService.currentLocation</span><span class="delimiter">'</span></span>, <span class="keyword">function</span> () {
    <span class="keyword">return</span> <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">locationService</span><span class="delimiter">'</span></span>).getCurrentCity();
  }),

  <span class="key">country</span>: computed(<span class="string"><span class="delimiter">'</span><span class="content">locationService.currentLocation</span><span class="delimiter">'</span></span>, <span class="keyword">function</span> () {
    <span class="keyword">return</span> <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">locationService</span><span class="delimiter">'</span></span>).getCurrentCountry();
  })
});
</pre></td>
</tr></table>
</div></div><div class="highlight handlebars "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">app/templates/components/location-indicator.hbs</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>You currently are located in <span class="inline"><span class="inline-delimiter">{{</span><span class="attribute-name">city</span><span class="inline-delimiter">}}</span></span>, <span class="inline"><span class="inline-delimiter">{{</span><span class="attribute-name">country</span><span class="inline-delimiter">}}</span></span>
</pre></td>
</tr></table>
</div></div>
<p>To stub the location service in your test, create a local stub object that extends
<code>Ember.Service</code>, and register the stub as the service your tests need in the
beforeEach function.  In this case we initially force location to New York.</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">tests/integration/components/location-indicator-test.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
<strong>20</strong>
21
22
23
24
25
26
27
28
29
</pre></td>
  <td class="code"><pre><span class="reserved">import</span> { module, test } from <span class="string"><span class="delimiter">'</span><span class="content">qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { setupRenderingTest } from <span class="string"><span class="delimiter">'</span><span class="content">ember-qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { render } from <span class="string"><span class="delimiter">'</span><span class="content">@ember/test-helpers</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> hbs from <span class="string"><span class="delimiter">'</span><span class="content">htmlbars-inline-precompile</span><span class="delimiter">'</span></span>;

<span class="comment">//Stub location service</span>
const locationStub = Service.extend({
  <span class="key">city</span>: <span class="string"><span class="delimiter">'</span><span class="content">New York</span><span class="delimiter">'</span></span>,
  <span class="key">country</span>: <span class="string"><span class="delimiter">'</span><span class="content">USA</span><span class="delimiter">'</span></span>,
  <span class="key">currentLocation</span>: {
    <span class="key">x</span>: <span class="integer">1234</span>,
    <span class="key">y</span>: <span class="integer">5678</span>
  },

  getCurrentCity() {
    <span class="keyword">return</span> <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">city</span><span class="delimiter">'</span></span>);
  },
  getCurrentCountry() {
    <span class="keyword">return</span> <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">country</span><span class="delimiter">'</span></span>);
  }
});

module(<span class="string"><span class="delimiter">'</span><span class="content">Integration | Component | location indicator</span><span class="delimiter">'</span></span>, <span class="keyword">function</span>(hooks) {
  setupRenderingTest(hooks);

  hooks.beforeEach(<span class="keyword">function</span>(assert) {
    <span class="local-variable">this</span>.owner.register(<span class="string"><span class="delimiter">'</span><span class="content">service:location-service</span><span class="delimiter">'</span></span>, locationStub);
  });
});
</pre></td>
</tr></table>
</div></div>
<p>Once the stub service is registered the test simply needs to check that the stub data that
is being returned from the service is reflected in the component output.</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><?xml version="1.0"?>
<table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">tests/integration/components/location-indicator-test.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
<strong>20</strong>
21
22
23
24
25
26
27
28
29
<strong>30</strong>
31
32
33
<span class="highlight-line added">34</span>
<span class="highlight-line added">35</span>
<span class="highlight-line added">36</span>
<span class="highlight-line added"/>
<span class="highlight-line added"/></pre></td>
  <td class="code"><pre><span class="reserved">import</span> { module, test } from <span class="string"><span class="delimiter">'</span><span class="content">qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { setupRenderingTest } from <span class="string"><span class="delimiter">'</span><span class="content">ember-qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { render } from <span class="string"><span class="delimiter">'</span><span class="content">@ember/test-helpers</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> hbs from <span class="string"><span class="delimiter">'</span><span class="content">htmlbars-inline-precompile</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> Service from <span class="string"><span class="delimiter">'</span><span class="content">@ember/service</span><span class="delimiter">'</span></span>;

<span class="comment">//Stub location service</span>
const locationStub = Service.extend({
  <span class="key">city</span>: <span class="string"><span class="delimiter">'</span><span class="content">New York</span><span class="delimiter">'</span></span>,
  <span class="key">country</span>: <span class="string"><span class="delimiter">'</span><span class="content">USA</span><span class="delimiter">'</span></span>,
  <span class="key">currentLocation</span>: {
    <span class="key">x</span>: <span class="integer">1234</span>,
    <span class="key">y</span>: <span class="integer">5678</span>
  },

  getCurrentCity() {
    <span class="keyword">return</span> <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">city</span><span class="delimiter">'</span></span>);
  },
  getCurrentCountry() {
    <span class="keyword">return</span> <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">country</span><span class="delimiter">'</span></span>);
  }
});

module(<span class="string"><span class="delimiter">'</span><span class="content">Integration | Component | location indicator</span><span class="delimiter">'</span></span>, <span class="keyword">function</span>(hooks) {
  setupRenderingTest(hooks);

  hooks.beforeEach(<span class="keyword">function</span>(assert) {
    <span class="local-variable">this</span>.owner.register(<span class="string"><span class="delimiter">'</span><span class="content">service:location-service</span><span class="delimiter">'</span></span>, locationStub);
  });

  test(<span class="string"><span class="delimiter">'</span><span class="content">should reveal current location</span><span class="delimiter">'</span></span>, async <span class="keyword">function</span>(assert) {
    await render(hbs<span class="error">`</span>{{location-indicator}}<span class="error">`</span>);
    assert.equal(<span class="local-variable">this</span>.element.textContent.trim(),
<span class="highlight-line added">     <span class="string"><span class="delimiter">'</span><span class="content">You currently are located in New York, USA</span><span class="delimiter">'</span></span>);</span>
<span class="highlight-line added">  });</span>
<span class="highlight-line added">});</span>
<span class="highlight-line added"/>
<span class="highlight-line added"/></pre></td>
</tr></table>
</div></div>
<p>In the next example, we&#39;ll add another test that validates that the display changes
when we modify the values on the service.</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><?xml version="1.0"?>
<table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">tests/integration/components/location-indicator-test.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
<strong>20</strong>
21
22
23
24
25
26
27
28
29
<strong>30</strong>
31
32
33
34
35
36
37
38
39
<span class="highlight-line added"><strong>40</strong></span>
<span class="highlight-line added">41</span>
<span class="highlight-line added">42</span>
<span class="highlight-line added">43</span>
<span class="highlight-line added">44</span>
<span class="highlight-line added">45</span>
<span class="highlight-line added">46</span>
<span class="highlight-line added">47</span>
<span class="highlight-line added">48</span>
<span class="highlight-line added">49</span>
<span class="highlight-line added"><strong>50</strong></span>
<span class="highlight-line added"/>
<span class="highlight-line added"/>
<span class="highlight-line added"/></pre></td>
  <td class="code"><pre><span class="reserved">import</span> { module, test } from <span class="string"><span class="delimiter">'</span><span class="content">qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { setupRenderingTest } from <span class="string"><span class="delimiter">'</span><span class="content">ember-qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { render } from <span class="string"><span class="delimiter">'</span><span class="content">@ember/test-helpers</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> hbs from <span class="string"><span class="delimiter">'</span><span class="content">htmlbars-inline-precompile</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> Service from <span class="string"><span class="delimiter">'</span><span class="content">@ember/service</span><span class="delimiter">'</span></span>;

<span class="comment">//Stub location service</span>
const locationStub = Service.extend({
  <span class="key">city</span>: <span class="string"><span class="delimiter">'</span><span class="content">New York</span><span class="delimiter">'</span></span>,
  <span class="key">country</span>: <span class="string"><span class="delimiter">'</span><span class="content">USA</span><span class="delimiter">'</span></span>,
  <span class="key">currentLocation</span>: {
    <span class="key">x</span>: <span class="integer">1234</span>,
    <span class="key">y</span>: <span class="integer">5678</span>
  },

  getCurrentCity() {
    <span class="keyword">return</span> <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">city</span><span class="delimiter">'</span></span>);
  },
  getCurrentCountry() {
    <span class="keyword">return</span> <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">country</span><span class="delimiter">'</span></span>);
  }
});

module(<span class="string"><span class="delimiter">'</span><span class="content">Integration | Component | location indicator</span><span class="delimiter">'</span></span>, <span class="keyword">function</span>(hooks) {
  setupRenderingTest(hooks);

  hooks.beforeEach(<span class="keyword">function</span>(assert) {
    <span class="local-variable">this</span>.owner.register(<span class="string"><span class="delimiter">'</span><span class="content">service:location-service</span><span class="delimiter">'</span></span>, locationStub);
  });

  test(<span class="string"><span class="delimiter">'</span><span class="content">should reveal current location</span><span class="delimiter">'</span></span>, <span class="keyword">function</span>(assert) {
    await render(hbs<span class="error">`</span>{{location-indicator}}<span class="error">`</span>);
    assert.equal(<span class="local-variable">this</span>.element.textContent.trim(),
     <span class="string"><span class="delimiter">'</span><span class="content">You currently are located in New York, USA</span><span class="delimiter">'</span></span>);
  });

  test(<span class="string"><span class="delimiter">'</span><span class="content">should change displayed location when current location changes</span><span class="delimiter">'</span></span>, async <span class="keyword">function</span> (assert) {
    await render(hbs<span class="error">`</span>{{location-indicator}}<span class="error">`</span>);

<span class="highlight-line added">    assert.equal(<span class="local-variable">this</span>.element.textContent.trim(),</span>
<span class="highlight-line added">     <span class="string"><span class="delimiter">'</span><span class="content">You currently are located in New York, USA</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">origin location should display</span><span class="delimiter">'</span></span>);</span>
<span class="highlight-line added"/>
<span class="highlight-line added">    <span class="local-variable">this</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">locationService.city</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Beijing</span><span class="delimiter">'</span></span>);</span>
<span class="highlight-line added">    <span class="local-variable">this</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">locationService.country</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">China</span><span class="delimiter">'</span></span>);</span>
<span class="highlight-line added">    <span class="local-variable">this</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">locationService.currentLocation</span><span class="delimiter">'</span></span>, { <span class="key">x</span>: <span class="integer">11111</span>, <span class="key">y</span>: <span class="integer">222222</span> });</span>
<span class="highlight-line added"/>
<span class="highlight-line added">    assert.equal(<span class="local-variable">this</span>.element.textContent.trim(),</span>
<span class="highlight-line added">     <span class="string"><span class="delimiter">'</span><span class="content">You currently are located in Beijing, China</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">location display should change</span><span class="delimiter">'</span></span>);</span>
<span class="highlight-line added">  });</span>
<span class="highlight-line added">});</span>
<span class="highlight-line added"/>
<span class="highlight-line added"/>
<span class="highlight-line added"/></pre></td>
</tr></table>
</div></div><h3 class='anchorable-toc' id='toc_waiting-on-asynchronous-behavior'>Waiting on Asynchronous Behavior</h3>
<p>Often, interacting with a component will cause asynchronous behavior to occur, such as HTTP requests, or timers.
The module <code>@ember/test-helpers</code> provides you with several <a href="https://github.com/emberjs/ember-test-helpers/blob/master/API.md">useful helpers</a> that will allow you to wait for any asynchronous
behavior to complete that is triggered by a DOM interaction induced by those.<br>
To use them in your tests, you can simply <code>await</code> any of them to make sure that subsequent assertions are executed at the right time
when the asynchronous behavior has fully settled:</p>
<div class="highlight js "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
2
</pre></td>
  <td class="code"><pre>await click(<span class="string"><span class="delimiter">'</span><span class="content">button.submit-button</span><span class="delimiter">'</span></span>); <span class="comment">// clicks a button and waits for any async behavior initiated by the click to settle</span>
assert.equal(<span class="local-variable">this</span>.element.querySelector(<span class="string"><span class="delimiter">'</span><span class="content">.form-message</span><span class="delimiter">'</span></span>).textContent, <span class="string"><span class="delimiter">'</span><span class="content">Your details have been submitted successfully.</span><span class="delimiter">'</span></span>);
</pre></td>
</tr></table>
</div></div>
<p>Nearly all of the helpers for DOM interaction from <code>@ember/test-helpers</code> return a call to <code>settled</code> - a function
that ensures that any Promises, operations in Ember&#39;s <code>run</code> loop, timers or Ajax requests have already resolved.
The <code>settled</code> function itself returns a Promise that resolves once all async operations have come to an end.</p>

<p>You can use <code>settled</code> as a helper in your tests directly and <code>await</code> it for all async behavior to settle deliberately.</p>

<p>Imagine you have a typeahead component that uses <a href="https://www.emberjs.com/api/ember/release/classes/@ember%2Frunloop/methods/debounce?anchor=debounce"><code>Ember.run.debounce</code></a>
to limit requests to the server, and you want to verify that results are displayed after typing a character.</p>

<blockquote>
<p>You can follow along by generating your own component with <code>ember generate
component delayed-typeahead</code>.</p>
</blockquote>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">app/components/delayed-typeahead.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
</pre></td>
  <td class="code"><pre><span class="reserved">import</span> Component from <span class="string"><span class="delimiter">'</span><span class="content">@ember/component</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { debounce } from <span class="string"><span class="delimiter">'</span><span class="content">@ember/runloop</span><span class="delimiter">'</span></span>;

<span class="reserved">export</span> <span class="keyword">default</span> Component.extend({
  <span class="key">actions</span>: {
    handleTyping() {
      <span class="comment">//the fetchResults function is passed into the component from its parent</span>
      debounce(<span class="local-variable">this</span>, <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">fetchResults</span><span class="delimiter">'</span></span>), <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">searchValue</span><span class="delimiter">'</span></span>), <span class="integer">250</span>);
    }
  }
});
</pre></td>
</tr></table>
</div></div><div class="highlight handlebars "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">app/templates/components/delayed-typeahead.hbs</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
</pre></td>
  <td class="code"><pre><span class="inline"><span class="inline-delimiter">{{</span><span class="attribute-name">input</span> <span class="attribute-name">value</span>=<span class="attribute-value">searchValue</span> <span class="attribute-name">key-up</span>=<span class="error">(</span><span class="attribute-value">action</span> <span class="error">'</span><span class="attribute-name">handleTyping</span><span class="error">'</span><span class="error">)</span><span class="inline-delimiter">}}</span></span>
<span class="tag">&lt;ul&gt;</span>
<span class="inline"><span class="inline-delimiter">{{#</span><span class="attribute-name">each</span> <span class="attribute-name">results</span> <span class="attribute-name">as</span> <span class="error">|</span><span class="attribute-name">result</span><span class="error">|</span><span class="inline-delimiter">}}</span></span>
  <span class="tag">&lt;li</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">result</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span><span class="inline"><span class="inline-delimiter">{{</span><span class="attribute-name">result.name</span><span class="inline-delimiter">}}</span></span><span class="tag">&lt;/li&gt;</span>
<span class="inline"><span class="inline-delimiter">{{/</span><span class="attribute-name">each</span><span class="inline-delimiter">}}</span></span>
<span class="tag">&lt;/ul&gt;</span>
</pre></td>
</tr></table>
</div></div>
<p>In your test, use the <code>settled</code> helper to wait until your debounce timer is up and then assert
that the page is rendered appropriately.</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">tests/integration/components/delayed-typeahead-test.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
<strong>20</strong>
21
22
23
24
25
26
27
28
29
<strong>30</strong>
</pre></td>
  <td class="code"><pre><span class="reserved">import</span> { module, test } from <span class="string"><span class="delimiter">'</span><span class="content">qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { setupRenderingTest } from <span class="string"><span class="delimiter">'</span><span class="content">ember-qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> { render, settled } from <span class="string"><span class="delimiter">'</span><span class="content">@ember/test-helpers</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> hbs from <span class="string"><span class="delimiter">'</span><span class="content">htmlbars-inline-precompile</span><span class="delimiter">'</span></span>;

module(<span class="string"><span class="delimiter">'</span><span class="content">Integration | Component | delayed typeahead</span><span class="delimiter">'</span></span>, {

  const stubResults = [
    { <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">result 1</span><span class="delimiter">'</span></span> },
    { <span class="key">name</span>: <span class="string"><span class="delimiter">'</span><span class="content">result 2</span><span class="delimiter">'</span></span> }
  ];

  test(<span class="string"><span class="delimiter">'</span><span class="content">should render results after typing a term</span><span class="delimiter">'</span></span>, async <span class="keyword">function</span>(assert) {
    assert.expect(<span class="integer">2</span>);

    <span class="local-variable">this</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">results</span><span class="delimiter">'</span></span>, []);
    <span class="local-variable">this</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">fetchResults</span><span class="delimiter">'</span></span>, (value) =&gt; {
      assert.equal(value, <span class="string"><span class="delimiter">'</span><span class="content">test</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">fetch closure action called with search value</span><span class="delimiter">'</span></span>);
      <span class="local-variable">this</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">results</span><span class="delimiter">'</span></span>, stubResults);
    });

    await render(hbs<span class="error">`</span>{{delayed-typeahead fetchResults=fetchResults results=results}}<span class="error">`</span>);
    <span class="local-variable">this</span>.element.querySelector(<span class="string"><span class="delimiter">'</span><span class="content">input</span><span class="delimiter">'</span></span>).value = <span class="string"><span class="delimiter">'</span><span class="content">test</span><span class="delimiter">'</span></span>;
    <span class="local-variable">this</span>.element.querySelector(<span class="string"><span class="delimiter">'</span><span class="content">input</span><span class="delimiter">'</span></span>).dispatchEvent(<span class="keyword">new</span> Event(<span class="string"><span class="delimiter">'</span><span class="content">keyup</span><span class="delimiter">'</span></span>));

    await settled();

    assert.equal(<span class="local-variable">this</span>.element.querySelector(<span class="string"><span class="delimiter">'</span><span class="content">.result</span><span class="delimiter">'</span></span>).length, <span class="integer">2</span>, <span class="string"><span class="delimiter">'</span><span class="content">two results rendered</span><span class="delimiter">'</span></span>);
  });
});
</pre></td>
</tr></table>
</div></div>


        
      <footer>
        <a class="previous-guide" href="../unit-testing-basics/">Testing Basics</a> <a class="next-guide" href="../testing-helpers/">Testing Helpers</a>
      </footer>
      
      </article>
    </main>

    <div class="footer">
  <div class="container">
    <div class="footer-info">
      Copyright 2018
      <a href="http://tilde.io">Tilde Inc.</a>
      <br>
      <a href="http://emberjs.com/team">Core Team</a> |
      <a href="http://emberjs.com/sponsors">Sponsors</a>
      <br>
      <a href="http://emberjs.com/security">Security</a> |
      <a href="http://emberjs.com/legal">Legal</a> |
      <a href="http://emberjs.com/logos">Logos</a>
      <br>
      <a href="http://emberjs.com/guidelines">Community Guidelines</a>
    </div>

    <div class="footer-statement">
      Ember.js is free, open source and always will be.
    </div>

    <div class="footer-social">
      <a href="http://twitter.com/emberjs"
        title="Twitter">
        <i class="icon-twitter"></i>
      </a>
      <a href="https://github.com/emberjs/ember.js"
        title="GitHub">
        <i class="icon-github"></i>
      </a>
      <a href="https://plus.google.com/communities/106387049790387471205"
        title="Google+">
        <i class="icon-gplus"></i>
      </a>
    </div>
  </div>
</div>


    

    <script type="text/javascript">
      var _gaq = _gaq || [];
      var pluginUrl = '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
      _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
      _gaq.push(['_setAccount', 'UA-27675533-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>
</html>
