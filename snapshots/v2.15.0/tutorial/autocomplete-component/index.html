<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="theme-color" content="#e46652">

    <title>Ember.js - Tutorial: Building a Complex Component</title>
    <meta property="st:title" content="Tutorial: Building a Complex Component" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="../../images/favicon.png" rel="icon" type="image/png" />
    <!--[if lte IE 7 ]><link href="../../stylesheets/fonts/fontello-ie7.css" rel="stylesheet" /><![endif]-->
    <link href="../../stylesheets/application.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,600" rel="stylesheet">
    <!-- This TypeKit account is managed by @wifelette. Contact her with any issues. -->
    <script src="https://use.typekit.net/stz3kpn.js"></script>
    <script>try{Typekit.load({ async: true });}catch(e){}</script>

    <link href="/blog/feed.xml" rel="alternate" type="application/atom+xml" title="Ember.js - Blog" />
    
  </head>

  <body class="guides tutorial tutorial_autocomplete-component tutorial_autocomplete-component_index">

    <!--[if lt IE 9]>
      <script src="../../javascripts/common-old-ie.js"></script>
    <![endif]-->
    <!--[if gte IE 9]><!-->
      <script src="../../javascripts/common-modern.js"></script>
    <!--<![endif]-->

    <header class="header">
  <nav role="navigation" aria-label="main">
    <ul class="header-nav container">
      <li class="header-logo">
        <a href="http://emberjs.com/"><span class="visually-hidden">Ember homepage</span></a>
      </li>
      <li>
        <a href="http://emberjs.com/learn">Learn</a>
      </li>
      <li class="active" aria-label="You are here">
        <a href="/">Guides</a>
      </li>
      <li>
        <a href="http://emberjs.com/api">API</a>
      </li>
      <li>
        <a href="http://emberjs.com/community">Community</a>
      </li>
      <li>
        <a href="http://emberjs.com/blog">Blog</a>
      </li>
      <li>
        <a href="http://emberjs.com/builds">Builds</a>
      </li>

      <li class="header-search">
        <form>
          <input type="text" id="search-input" class="search-input" placeholder="Search the guides"/>
        </form>
      </li>
    </ul>
  </nav>
</header>


    

    <main class="container">

      <aside class="sidebar">
  <label for="version-select" class="visually-hidden">Guides version</label>
  <select class="version-select" id="version-select" style="width: 100%"></select>

  <input id="toc-toggle" class="toc-toggle visually-hidden" type="checkbox" />
  <label for="toc-toggle">Table of Contents <span class="visually-hidden">toggle</span></label>

  <nav class='toc-container' aria-label='table of contents'><ol class='toc-level-0 selected'><li class='toc-level-0 '><a href="#">Getting Started</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../getting-started/quick-start/">Quick Start</a></li><li class='toc-level-1 '><a href="../../getting-started/">Installing Ember</a></li><li class='toc-level-1 '><a href="../../getting-started/core-concepts/">Core Concepts</a></li></ol></li><li class='toc-level-0 selected'><a href="#">Tutorial</a><ol class='toc-level-1 selected'><li class='toc-level-1 '><a href="../ember-cli/">Creating Your App</a></li><li class='toc-level-1 '><a href="../acceptance-test/">Planning Your App</a></li><li class='toc-level-1 '><a href="../routes-and-templates/">Routes and Templates</a></li><li class='toc-level-1 '><a href="../model-hook/">The Model Hook</a></li><li class='toc-level-1 '><a href="../installing-addons/">Installing Addons</a></li><li class='toc-level-1 '><a href="../simple-component/">Building a Simple Component</a></li><li class='toc-level-1 '><a href="../hbs-helper/">Creating a Handlebars Helper</a></li><li class='toc-level-1 '><a href="../ember-data/">Using Ember Data</a></li><li class='toc-level-1 selected'><a href="./">Building a Complex Component</a></li><li class='toc-level-1 '><a href="../service/">Services and Utilities</a></li><li class='toc-level-1 '><a href="../subroutes/">Adding Nested Routes</a></li><li class='toc-level-1 '><a href="../deploying/">Deploying</a></li></ol></li><li class='toc-level-0 '><a href="#">The Object Model</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../object-model/">Objects in Ember</a></li><li class='toc-level-1 '><a href="../../object-model/classes-and-instances/">Classes and Instances</a></li><li class='toc-level-1 '><a href="../../object-model/reopening-classes-and-instances/">Reopening Classes and Instances</a></li><li class='toc-level-1 '><a href="../../object-model/computed-properties/">Computed Properties</a></li><li class='toc-level-1 '><a href="../../object-model/computed-properties-and-aggregate-data/">Computed Properties and Aggregate Data</a></li><li class='toc-level-1 '><a href="../../object-model/observers/">Observers</a></li><li class='toc-level-1 '><a href="../../object-model/bindings/">Bindings</a></li><li class='toc-level-1 '><a href="../../object-model/enumerables/">Enumerables</a></li></ol></li><li class='toc-level-0 '><a href="#">Routing</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../routing/">Introduction</a></li><li class='toc-level-1 '><a href="../../routing/defining-your-routes/">Defining Your Routes</a></li><li class='toc-level-1 '><a href="../../routing/specifying-a-routes-model/">Specifying a Route's Model</a></li><li class='toc-level-1 '><a href="../../routing/rendering-a-template/">Rendering a Template</a></li><li class='toc-level-1 '><a href="../../routing/redirection/">Redirecting</a></li><li class='toc-level-1 '><a href="../../routing/preventing-and-retrying-transitions/">Preventing and Retrying Transitions</a></li><li class='toc-level-1 '><a href="../../routing/loading-and-error-substates/">Loading / Error Substates</a></li><li class='toc-level-1 '><a href="../../routing/query-params/">Query Parameters</a></li><li class='toc-level-1 '><a href="../../routing/asynchronous-routing/">Asynchronous Routing</a></li></ol></li><li class='toc-level-0 '><a href="#">Templates</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../templates/handlebars-basics/">Handlebars Basics</a></li><li class='toc-level-1 '><a href="../../templates/built-in-helpers/">Built-in Helpers</a></li><li class='toc-level-1 '><a href="../../templates/conditionals/">Conditionals</a></li><li class='toc-level-1 '><a href="../../templates/displaying-a-list-of-items/">Displaying a List of Items</a></li><li class='toc-level-1 '><a href="../../templates/displaying-the-keys-in-an-object/">Displaying the Keys in an Object</a></li><li class='toc-level-1 '><a href="../../templates/binding-element-attributes/">Binding Element Attributes</a></li><li class='toc-level-1 '><a href="../../templates/links/">Links</a></li><li class='toc-level-1 '><a href="../../templates/actions/">Actions</a></li><li class='toc-level-1 '><a href="../../templates/input-helpers/">Input Helpers</a></li><li class='toc-level-1 '><a href="../../templates/development-helpers/">Development Helpers</a></li><li class='toc-level-1 '><a href="../../templates/writing-helpers/">Writing Helpers</a></li></ol></li><li class='toc-level-0 '><a href="#">Components</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../components/defining-a-component/">Defining a Component</a></li><li class='toc-level-1 '><a href="../../components/the-component-lifecycle/">The Component Lifecycle</a></li><li class='toc-level-1 '><a href="../../components/passing-properties-to-a-component/">Passing Properties to a Component</a></li><li class='toc-level-1 '><a href="../../components/wrapping-content-in-a-component/">Wrapping Content in a Component</a></li><li class='toc-level-1 '><a href="../../components/customizing-a-components-element/">Customizing a Component's Element</a></li><li class='toc-level-1 '><a href="../../components/block-params/">Using Block Params</a></li><li class='toc-level-1 '><a href="../../components/handling-events/">Handling Events</a></li><li class='toc-level-1 '><a href="../../components/triggering-changes-with-actions/">Triggering Changes with Actions</a></li></ol></li><li class='toc-level-0 '><a href="#">Controllers</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../controllers/">Introduction</a></li></ol></li><li class='toc-level-0 '><a href="#">Models</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../models/">Introduction</a></li><li class='toc-level-1 '><a href="../../models/defining-models/">Defining Models</a></li><li class='toc-level-1 '><a href="../../models/finding-records/">Finding Records</a></li><li class='toc-level-1 '><a href="../../models/creating-updating-and-deleting-records/">Creating, Updating and Deleting</a></li><li class='toc-level-1 '><a href="../../models/relationships/">Relationships</a></li><li class='toc-level-1 '><a href="../../models/pushing-records-into-the-store/">Pushing Records into the Store</a></li><li class='toc-level-1 '><a href="../../models/handling-metadata/">Handling Metadata</a></li><li class='toc-level-1 '><a href="../../models/customizing-adapters/">Customizing Adapters</a></li><li class='toc-level-1 '><a href="../../models/customizing-serializers/">Customizing Serializers</a></li></ol></li><li class='toc-level-0 '><a href="#">Application Concerns</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../applications/applications-and-instances/">Applications and Instances</a></li><li class='toc-level-1 '><a href="../../applications/dependency-injection/">Dependency Injection</a></li><li class='toc-level-1 '><a href="../../applications/initializers/">Initializers</a></li><li class='toc-level-1 '><a href="../../applications/services/">Services</a></li><li class='toc-level-1 '><a href="../../applications/run-loop/">The Run Loop</a></li></ol></li><li class='toc-level-0 '><a href="#">Testing</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../testing/">Introduction</a></li><li class='toc-level-1 '><a href="../../testing/acceptance/">Acceptance Tests</a></li><li class='toc-level-1 '><a href="../../testing/unit-testing-basics/">Unit Testing Basics</a></li><li class='toc-level-1 '><a href="../../testing/testing-components/">Testing Components</a></li><li class='toc-level-1 '><a href="../../testing/testing-helpers/">Testing Helpers</a></li><li class='toc-level-1 '><a href="../../testing/testing-controllers/">Testing Controllers</a></li><li class='toc-level-1 '><a href="../../testing/testing-routes/">Testing Routes</a></li><li class='toc-level-1 '><a href="../../testing/testing-models/">Testing Models</a></li></ol></li><li class='toc-level-0 '><a href="#">Ember Inspector</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../ember-inspector/">Introduction</a></li><li class='toc-level-1 '><a href="../../ember-inspector/installation/">Installing the Inspector</a></li><li class='toc-level-1 '><a href="../../ember-inspector/object-inspector/">Object Inspector</a></li><li class='toc-level-1 '><a href="../../ember-inspector/view-tree/">The View Tree</a></li><li class='toc-level-1 '><a href="../../ember-inspector/routes/">Inspecting Routes</a></li><li class='toc-level-1 '><a href="../../ember-inspector/data/">Data Tab</a></li><li class='toc-level-1 '><a href="../../ember-inspector/deprecations/">Tackling Deprecations</a></li><li class='toc-level-1 '><a href="../../ember-inspector/info/">Library Info</a></li><li class='toc-level-1 '><a href="../../ember-inspector/promises/">Debugging Promises</a></li><li class='toc-level-1 '><a href="../../ember-inspector/container/">Inspecting Objects via the Container</a></li><li class='toc-level-1 '><a href="../../ember-inspector/render-performance/">Rendering Performance</a></li><li class='toc-level-1 '><a href="../../ember-inspector/troubleshooting/">Troubleshooting</a></li></ol></li><li class='toc-level-0 '><a href="#">Addons and Dependencies</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../addons-and-dependencies/managing-dependencies/">Managing Dependencies</a></li></ol></li><li class='toc-level-0 '><a href="#">Configuring Ember.js</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../configuring-ember/configuring-your-app/">Configuring Your App</a></li><li class='toc-level-1 '><a href="../../configuring-ember/configuring-ember-cli/">Configuring Ember CLI</a></li><li class='toc-level-1 '><a href="../../configuring-ember/handling-deprecations/">Handling Deprecations</a></li><li class='toc-level-1 '><a href="../../configuring-ember/disabling-prototype-extensions/">Disabling Prototype Extensions</a></li><li class='toc-level-1 '><a href="../../configuring-ember/specifying-url-type/">Specifying the URL Type</a></li><li class='toc-level-1 '><a href="../../configuring-ember/embedding-applications/">Embedding Applications</a></li><li class='toc-level-1 '><a href="../../configuring-ember/feature-flags/">Feature Flags</a></li><li class='toc-level-1 '><a href="../../configuring-ember/build-targets/">Build targets</a></li><li class='toc-level-1 '><a href="../../configuring-ember/debugging/">Debugging</a></li></ol></li><li class='toc-level-0 '><a href="#">Contributing to Ember.js</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../contributing/adding-new-features/">Adding New Features</a></li><li class='toc-level-1 '><a href="../../contributing/repositories/">Repositories</a></li></ol></li><li class='toc-level-0 '><a href="#">Glossary</a><ol class='toc-level-1'><li class='toc-level-1 '><a href="../../glossary/web-development/">Web Development</a></li></ol></li></ol></nav>

  <a class="back-to-top" href="#">&#11014; Back to Top</a>
</aside>


      <article class="chapter">
        <h1>
          Building a Complex Component
          <a href="https://github.com/emberjs/guides/edit/master/source/tutorial/autocomplete-component.md"
             target="_blank" class="edit-page icon-pencil">Edit Page</a>
        </h1>
        <hr>

        <p>As they search for a rental, users might also want to narrow their search to a specific city.
While our <a href="../simple-component/">initial</a> rental listing component only displayed rental information, this new filter component will also allow the user to provide input in the form of filter criteria.</p>

<p>To begin, let&#39;s generate our new component.
We&#39;ll call this component <code>list-filter</code>, since all we want our component to do is filter the list of rentals based on input.</p>
<div class="highlight shell "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>ember g component list-filter
</pre></td>
</tr></table>
</div></div>
<p>As before when we created the <a href="../simple-component"><code>rental-listing</code> component</a>, the &quot;generate component&quot; CLI command creates</p>

<ul>
<li>a Handlebars template (<code>app/templates/components/list-filter.hbs</code>),</li>
<li>a JavaScript file (<code>app/components/list-filter.js</code>),</li>
<li>and a component integration test (<code>tests/integration/components/list-filter-test.js</code>).</li>
</ul>
<h4 class='anchorable-toc' id='toc_providing-markup-to-a-component'>Providing Markup to a Component</h4>
<p>In our <code>app/templates/rentals.hbs</code> template file, we&#39;ll add a reference to our new <code>list-filter</code> component.</p>

<p>Notice that below we &quot;wrap&quot; our rentals markup inside the open and closing mentions of <code>list-filter</code> on lines 12 and 20.
This is an example of the <a href="../../components/wrapping-content-in-a-component"><strong>block form</strong></a> of a component,
which allows a Handlebars template to be rendered <em>inside</em> the component&#39;s template wherever the <code>{{yield}}</code> expression appears.</p>

<p>In this case we are passing, or &quot;yielding&quot;, our filter data to the inner markup as a variable called <code>rentals</code> (line 14).</p>
<div class="highlight handlebars "><div class="ribbon"></div><div class="scroller"><?xml version="1.0"?>
<table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">app/templates/rentals.hbs</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
<span class="highlight-line added">12</span>
<span class="highlight-line added">13</span>
<span class="highlight-line added">14</span>
<span class="highlight-line added">15</span>
<span class="highlight-line added">16</span>
<span class="highlight-line added">17</span>
<span class="highlight-line added">18</span>
<span class="highlight-line added">19</span>
<span class="highlight-line added"><strong>20</strong></span>
<span class="highlight-line removed">21</span>
<span class="highlight-line removed">22</span>
<span class="highlight-line removed">23</span></pre></td>
  <td class="code"><pre><span class="tag">&lt;div</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">jumbo</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
  <span class="tag">&lt;div</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">right tomster</span><span class="delimiter">"</span></span><span class="tag">&gt;</span><span class="tag">&lt;/div&gt;</span>
  <span class="tag">&lt;h2&gt;</span>Welcome!<span class="tag">&lt;/h2&gt;</span>
  <span class="tag">&lt;p&gt;</span>
    We hope you find exactly what you're looking for in a place to stay.
  <span class="tag">&lt;/p&gt;</span>
  <span class="inline"><span class="inline-delimiter">{{#</span><span class="attribute-name">link-to</span> <span class="error">'</span><span class="attribute-name">about</span><span class="error">'</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">button</span><span class="delimiter">"</span></span><span class="inline-delimiter">}}</span></span>
    About Us
  <span class="inline"><span class="inline-delimiter">{{/</span><span class="attribute-name">link-to</span><span class="inline-delimiter">}}</span></span>
<span class="tag">&lt;/div&gt;</span>

<span class="highlight-line added"><span class="inline"><span class="inline-delimiter">{{#</span><span class="attribute-name">list-filter</span></span>
<span class="highlight-line added">   <span class="attribute-name">filter</span>=<span class="error">(</span><span class="attribute-value">action</span> <span class="error">'</span><span class="attribute-name">filterByCity</span><span class="error">'</span><span class="error">)</span></span>
<span class="highlight-line added">   <span class="attribute-name">as</span> <span class="error">|</span><span class="attribute-name">rentals</span><span class="error">|</span><span class="inline-delimiter">}}</span></span></span>
<span class="highlight-line added">  <span class="tag">&lt;ul</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">results</span><span class="delimiter">"</span></span><span class="tag">&gt;</span></span>
<span class="highlight-line added">    <span class="inline"><span class="inline-delimiter">{{#</span><span class="attribute-name">each</span> <span class="attribute-name">rentals</span> <span class="attribute-name">as</span> <span class="error">|</span><span class="attribute-name">rentalUnit</span><span class="error">|</span><span class="inline-delimiter">}}</span></span></span>
<span class="highlight-line added">      <span class="tag">&lt;li&gt;</span><span class="inline"><span class="inline-delimiter">{{</span><span class="attribute-name">rental-listing</span> <span class="attribute-name">rental</span>=<span class="attribute-value">rentalUnit</span><span class="inline-delimiter">}}</span></span><span class="tag">&lt;/li&gt;</span></span>
<span class="highlight-line added">    <span class="inline"><span class="inline-delimiter">{{/</span><span class="attribute-name">each</span><span class="inline-delimiter">}}</span></span></span>
<span class="highlight-line added">  <span class="tag">&lt;/ul&gt;</span></span>
<span class="highlight-line added"><span class="inline"><span class="inline-delimiter">{{/</span><span class="attribute-name">list-filter</span><span class="inline-delimiter">}}</span></span></span>
<span class="highlight-line removed"><span class="inline"><span class="inline-delimiter">{{#</span><span class="attribute-name">each</span> <span class="attribute-name">model</span> <span class="attribute-name">as</span> <span class="error">|</span><span class="attribute-name">rentalUnit</span><span class="error">|</span><span class="inline-delimiter">}}</span></span></span>
<span class="highlight-line removed">  <span class="inline"><span class="inline-delimiter">{{</span><span class="attribute-name">rental-listing</span> <span class="attribute-name">rental</span>=<span class="attribute-value">rentalUnit</span><span class="inline-delimiter">}}</span></span></span>
<span class="highlight-line removed"><span class="inline"><span class="inline-delimiter">{{/</span><span class="attribute-name">each</span><span class="inline-delimiter">}}</span></span></span></pre></td>
</tr></table>
</div></div><h4 class='anchorable-toc' id='toc_accepting-input-to-a-component'>Accepting Input to a Component</h4>
<p>We want the component to simply provide an input field and yield the results list to its block, so our template will be simple:</p>
<div class="highlight handlebars "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">app/templates/components/list-filter.hbs</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
</pre></td>
  <td class="code"><pre><span class="inline"><span class="inline-delimiter">{{</span><span class="attribute-name">input</span> <span class="attribute-name">value</span>=<span class="attribute-value">value</span>
        <span class="attribute-name">key-up</span>=<span class="error">(</span><span class="attribute-value">action</span> <span class="error">'</span><span class="attribute-name">handleFilterEntry</span><span class="error">'</span><span class="error">)</span>
        <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">light</span><span class="delimiter">&quot;</span></span>
        <span class="attribute-name">placeholder</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">Filter By City</span><span class="delimiter">&quot;</span></span><span class="inline-delimiter">}}</span></span>
<span class="inline"><span class="inline-delimiter">{{</span><span class="attribute-name">yield</span> <span class="attribute-name">results</span><span class="inline-delimiter">}}</span></span>
</pre></td>
</tr></table>
</div></div>
<p>The template contains an <a href="../../templates/input-helpers"><code>{{input}}</code></a> helper that renders as a text field, in which the user can type a pattern to filter the list of cities used in a search.
The <code>value</code> property of the <code>input</code> will be kept in sync with the <code>value</code> property in the component.</p>

<p>Another way to say this is that the <code>value</code> property of <code>input</code> is <a href="../../object-model/bindings/"><strong>bound</strong></a> to the <code>value</code> property of the component.
If the property changes, either by the user typing in the input field, or by assigning a new value to it in our program,
the new value of the property is present in both the rendered web page and in the code.</p>

<p>The <code>key-up</code> property will be bound to the <code>handleFilterEntry</code> action.</p>

<p>Here is what the component&#39;s JavaScript looks like:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">app/components/list-filter.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
<strong>20</strong>
</pre></td>
  <td class="code"><pre><span class="reserved">import</span> Ember from <span class="string"><span class="delimiter">'</span><span class="content">ember</span><span class="delimiter">'</span></span>;

<span class="reserved">export</span> <span class="keyword">default</span> Ember.Component.extend({
  <span class="key">classNames</span>: [<span class="string"><span class="delimiter">'</span><span class="content">list-filter</span><span class="delimiter">'</span></span>],
  <span class="key">value</span>: <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>,

  init() {
    <span class="local-variable">this</span>._super(...<span class="local-variable">arguments</span>);
    <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">filter</span><span class="delimiter">'</span></span>)(<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>).then((results) =&gt; <span class="local-variable">this</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">results</span><span class="delimiter">'</span></span>, results));
  },

  <span class="key">actions</span>: {
    handleFilterEntry() {
      let filterInputValue = <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">value</span><span class="delimiter">'</span></span>);
      let filterAction = <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">filter</span><span class="delimiter">'</span></span>);
      filterAction(filterInputValue).then((filterResults) =&gt; <span class="local-variable">this</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">results</span><span class="delimiter">'</span></span>, filterResults));
    }
  }

});
</pre></td>
</tr></table>
</div></div><h4 class='anchorable-toc' id='toc_filtering-data-based-on-input'>Filtering Data Based on Input</h4>
<p>In the above example we use the <code>init</code> hook to seed our initial listings by calling the <code>filter</code> action with an empty value.
Our <code>handleFilterEntry</code> action calls a function called <code>filter</code> based on the <code>value</code> attribute set by the input helper.</p>

<p>The <code>filter</code> function is passed in by the calling object. This is a pattern known as <a href="../../components/triggering-changes-with-actions/#toc_passing-the-action-to-the-component">closure actions</a>.</p>

<p>Notice the <code>then</code> function called on the result of calling the <code>filter</code> function.
The code expects the <code>filter</code> function to return a promise.
A <a href="http://emberjs.com/api/classes/RSVP.Promise.html">promise</a> is a JavaScript object that represents the result of an asynchronous function.
A promise may or may not be executed at the time you receive it.
To account for this, it provides functions, like <code>then</code> that let you give it code it will run when it eventually does receive a result.</p>

<p>To implement the <code>filter</code> function to do the actual filter of rentals by city, we&#39;ll create a <code>rentals</code> controller.
<a href="../../controllers/">Controllers</a> contain actions and properties available to the template of its corresponding route.
In our case we want to generate a controller called <code>rentals</code>.
Ember will know that a controller with the name of <code>rentals</code> will apply to the route with the same name.</p>

<p>Generate a controller for the <code>rentals</code> route by running the following:</p>
<div class="highlight shell "><div class="ribbon"></div><div class="scroller"><table class="CodeRay"><tr>
  <td class="line-numbers"><pre>1
</pre></td>
  <td class="code"><pre>ember g controller rentals
</pre></td>
</tr></table>
</div></div>
<p>Now, define your new controller like so:</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">app/controllers/rentals.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
</pre></td>
  <td class="code"><pre><span class="reserved">import</span> Ember from <span class="string"><span class="delimiter">'</span><span class="content">ember</span><span class="delimiter">'</span></span>;

<span class="reserved">export</span> <span class="keyword">default</span> Ember.Controller.extend({
  <span class="key">actions</span>: {
    filterByCity(param) {
      <span class="keyword">if</span> (param !== <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>) {
        <span class="keyword">return</span> <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">store</span><span class="delimiter">'</span></span>).query(<span class="string"><span class="delimiter">'</span><span class="content">rental</span><span class="delimiter">'</span></span>, { <span class="key">city</span>: param });
      } <span class="keyword">else</span> {
        <span class="keyword">return</span> <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">store</span><span class="delimiter">'</span></span>).findAll(<span class="string"><span class="delimiter">'</span><span class="content">rental</span><span class="delimiter">'</span></span>);
      }
    }
  }
});
</pre></td>
</tr></table>
</div></div>
<p>When the user types in the text field in our component, the <code>filterByCity</code> action in the controller is called.
This action takes in the <code>value</code> property, and filters the <code>rental</code> data for records in data store that match what the user has typed thus far.
The result of the query is returned to the caller.</p>
<h4 class='anchorable-toc' id='toc_faking-query-results'>Faking Query Results</h4>
<p>For this action to work, we need to replace our Mirage <code>config.js</code> file with the following, so that it can respond to our queries.
Instead of simply returning the list of rentals, our Mirage HTTP GET handler for <code>rentals</code> will return rentals matching the string provided in the URL query parameter called <code>city</code>.</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">mirage/config.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
<strong>20</strong>
21
22
23
24
25
26
27
28
29
<strong>30</strong>
31
32
33
34
35
36
37
38
39
<strong>40</strong>
41
42
43
44
45
46
47
48
49
<strong>50</strong>
51
52
</pre></td>
  <td class="code"><pre><span class="reserved">export</span> <span class="keyword">default</span> <span class="keyword">function</span>() {
  <span class="local-variable">this</span>.namespace = <span class="string"><span class="delimiter">'</span><span class="content">/api</span><span class="delimiter">'</span></span>;

  let rentals = [{
      <span class="key">type</span>: <span class="string"><span class="delimiter">'</span><span class="content">rentals</span><span class="delimiter">'</span></span>,
      <span class="key">id</span>: <span class="string"><span class="delimiter">'</span><span class="content">grand-old-mansion</span><span class="delimiter">'</span></span>,
      <span class="key">attributes</span>: {
        <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Grand Old Mansion</span><span class="delimiter">'</span></span>,
        <span class="key">owner</span>: <span class="string"><span class="delimiter">'</span><span class="content">Veruca Salt</span><span class="delimiter">'</span></span>,
        <span class="key">city</span>: <span class="string"><span class="delimiter">'</span><span class="content">San Francisco</span><span class="delimiter">'</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">property-type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">'</span><span class="content">Estate</span><span class="delimiter">'</span></span>,
        <span class="key">bedrooms</span>: <span class="integer">15</span>,
        <span class="key">image</span>: <span class="string"><span class="delimiter">'</span><span class="content">https://upload.wikimedia.org/wikipedia/commons/c/cb/Crane_estate_(5).jpg</span><span class="delimiter">'</span></span>,
        <span class="key">description</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">This grand old mansion sits on over 100 acres of rolling hills and dense redwood forests.</span><span class="delimiter">&quot;</span></span>
      }
    }, {
      <span class="key">type</span>: <span class="string"><span class="delimiter">'</span><span class="content">rentals</span><span class="delimiter">'</span></span>,
      <span class="key">id</span>: <span class="string"><span class="delimiter">'</span><span class="content">urban-living</span><span class="delimiter">'</span></span>,
      <span class="key">attributes</span>: {
        <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Urban Living</span><span class="delimiter">'</span></span>,
        <span class="key">owner</span>: <span class="string"><span class="delimiter">'</span><span class="content">Mike Teavee</span><span class="delimiter">'</span></span>,
        <span class="key">city</span>: <span class="string"><span class="delimiter">'</span><span class="content">Seattle</span><span class="delimiter">'</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">property-type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">'</span><span class="content">Condo</span><span class="delimiter">'</span></span>,
        <span class="key">bedrooms</span>: <span class="integer">1</span>,
        <span class="key">image</span>: <span class="string"><span class="delimiter">'</span><span class="content">https://upload.wikimedia.org/wikipedia/commons/0/0e/Alfonso_13_Highrise_Tegucigalpa.jpg</span><span class="delimiter">'</span></span>,
        <span class="key">description</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">A commuters dream. This rental is within walking distance of 2 bus stops and the Metro.</span><span class="delimiter">&quot;</span></span>
      }
    }, {
      <span class="key">type</span>: <span class="string"><span class="delimiter">'</span><span class="content">rentals</span><span class="delimiter">'</span></span>,
      <span class="key">id</span>: <span class="string"><span class="delimiter">'</span><span class="content">downtown-charm</span><span class="delimiter">'</span></span>,
      <span class="key">attributes</span>: {
        <span class="key">title</span>: <span class="string"><span class="delimiter">'</span><span class="content">Downtown Charm</span><span class="delimiter">'</span></span>,
        <span class="key">owner</span>: <span class="string"><span class="delimiter">'</span><span class="content">Violet Beauregarde</span><span class="delimiter">'</span></span>,
        <span class="key">city</span>: <span class="string"><span class="delimiter">'</span><span class="content">Portland</span><span class="delimiter">'</span></span>,
        <span class="key"><span class="delimiter">&quot;</span><span class="content">property-type</span><span class="delimiter">&quot;</span></span>: <span class="string"><span class="delimiter">'</span><span class="content">Apartment</span><span class="delimiter">'</span></span>,
        <span class="key">bedrooms</span>: <span class="integer">3</span>,
        <span class="key">image</span>: <span class="string"><span class="delimiter">'</span><span class="content">https://upload.wikimedia.org/wikipedia/commons/f/f7/Wheeldon_Apartment_Building_-_Portland_Oregon.jpg</span><span class="delimiter">'</span></span>,
        <span class="key">description</span>: <span class="string"><span class="delimiter">&quot;</span><span class="content">Convenience is at your doorstep with this charming downtown rental. Great restaurants and active night life are within a few feet.</span><span class="delimiter">&quot;</span></span>
      }
    }];

  <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">/rentals</span><span class="delimiter">'</span></span>, <span class="keyword">function</span>(db, request) {
    <span class="keyword">if</span>(request.queryParams.city !== <span class="predefined-constant">undefined</span>) {
      let filteredRentals = rentals.filter(<span class="keyword">function</span>(i) {
        <span class="keyword">return</span> i.attributes.city.toLowerCase().indexOf(request.queryParams.city.toLowerCase()) !== -<span class="integer">1</span>;
      });
      <span class="keyword">return</span> { <span class="key">data</span>: filteredRentals };
    } <span class="keyword">else</span> {
      <span class="keyword">return</span> { <span class="key">data</span>: rentals };
    }
  });
}
</pre></td>
</tr></table>
</div></div>
<p>After updating our mirage configuration, we should see a simple filter on the home screen that will update the rental list as you type:</p>

<p><img src="../../images/autocomplete-component/styled-super-rentals-filter.png" alt="home screen with filter component"></p>
<h4 class='anchorable-toc' id='toc_handling-results-coming-back-at-different-times'>Handling Results Coming Back at Different Times</h4>
<p>In our example, you might notice that if you type quickly that the results might get out of sync with the current filter text entered.
This is because our data filtering function is <em>asynchronous</em>, meaning that the code in the function gets scheduled for later, while the code that calls the function continues to execute.
Often code that may make network requests is set up to be asynchronous because the server may return its responses at varying times.</p>

<p>Lets add some protective code to ensure our results do not get out of sync with our filter input.
To do this we&#39;ll simply provide the filter text to the filter function, so that when the results come back we can compare the original filter value with the current filter value.
We will update the results on screen only if the original filter value and the current filter value are the same.</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><?xml version="1.0"?>
<table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">app/controllers/rentals.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
<span class="highlight-line removed">7</span>
<span class="highlight-line added">8</span>
<span class="highlight-line added">9</span>
<span class="highlight-line added"><strong>10</strong></span>
<span class="highlight-line added">11</span>
12
<span class="highlight-line removed">13</span>
<span class="highlight-line added">14</span>
<span class="highlight-line added">15</span>
<span class="highlight-line added">16</span>
<span class="highlight-line added">17</span>
18
19
<strong>20</strong>
21</pre></td>
  <td class="code"><pre><span class="reserved">import</span> Ember from <span class="string"><span class="delimiter">'</span><span class="content">ember</span><span class="delimiter">'</span></span>;

<span class="reserved">export</span> <span class="keyword">default</span> Ember.Controller.extend({
  <span class="key">actions</span>: {
    filterByCity(param) {
      <span class="keyword">if</span> (param !== <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>) {
<span class="highlight-line removed">        <span class="keyword">return</span> <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">store</span><span class="delimiter">'</span></span>).query(<span class="string"><span class="delimiter">'</span><span class="content">rental</span><span class="delimiter">'</span></span>, { <span class="key">city</span>: param });</span>
<span class="highlight-line added">        <span class="keyword">return</span> <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">store</span><span class="delimiter">'</span></span>)</span>
<span class="highlight-line added">          .query(<span class="string"><span class="delimiter">'</span><span class="content">rental</span><span class="delimiter">'</span></span>, { <span class="key">city</span>: param }).then((results) =&gt; {</span>
<span class="highlight-line added">            <span class="keyword">return</span> { <span class="key">query</span>: param, <span class="key">results</span>: results };</span>
<span class="highlight-line added">          });</span>
      } <span class="keyword">else</span> {
<span class="highlight-line removed">        <span class="keyword">return</span> <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">store</span><span class="delimiter">'</span></span>).findAll(<span class="string"><span class="delimiter">'</span><span class="content">rental</span><span class="delimiter">'</span></span>);</span>
<span class="highlight-line added">        <span class="keyword">return</span> <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">store</span><span class="delimiter">'</span></span>)</span>
<span class="highlight-line added">          .findAll(<span class="string"><span class="delimiter">'</span><span class="content">rental</span><span class="delimiter">'</span></span>).then((results) =&gt; {</span>
<span class="highlight-line added">            <span class="keyword">return</span> { <span class="key">query</span>: param, <span class="key">results</span>: results };</span>
<span class="highlight-line added">          });</span>
      }
    }
  }
});</pre></td>
</tr></table>
</div></div>
<p>In the <code>filterByCity</code> function in the rental controller above,
we&#39;ve added a new property called <code>query</code> to the filter results instead of just returning an array of rentals as before.</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><?xml version="1.0"?>
<table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">app/components/list-filter.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
<span class="highlight-line added">9</span>
<span class="highlight-line added"><strong>10</strong></span>
<span class="highlight-line added">11</span>
12
13
14
15
16
17
18
<span class="highlight-line added">19</span>
<span class="highlight-line added"><strong>20</strong></span>
<span class="highlight-line added">21</span>
22
23
24
25
26</pre></td>
  <td class="code"><pre><span class="reserved">import</span> Ember from <span class="string"><span class="delimiter">'</span><span class="content">ember</span><span class="delimiter">'</span></span>;

<span class="reserved">export</span> <span class="keyword">default</span> Ember.Component.extend({
  <span class="key">classNames</span>: [<span class="string"><span class="delimiter">'</span><span class="content">list-filter</span><span class="delimiter">'</span></span>],
  <span class="key">value</span>: <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>,

  init() {
    <span class="local-variable">this</span>._super(...<span class="local-variable">arguments</span>);
<span class="highlight-line added">    <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">filter</span><span class="delimiter">'</span></span>)(<span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>).then((allResults) =&gt; {</span>
<span class="highlight-line added">      <span class="local-variable">this</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">results</span><span class="delimiter">'</span></span>, allResults.results);</span>
<span class="highlight-line added">    });</span>
  },

  <span class="key">actions</span>: {
    handleFilterEntry() {
      let filterInputValue = <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">value</span><span class="delimiter">'</span></span>);
      let filterAction = <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">filter</span><span class="delimiter">'</span></span>);
      filterAction(filterInputValue).then((resultsObj) =&gt; {
<span class="highlight-line added">        <span class="keyword">if</span> (resultsObj.query === <span class="local-variable">this</span>.get(<span class="string"><span class="delimiter">'</span><span class="content">value</span><span class="delimiter">'</span></span>)) {</span>
<span class="highlight-line added">          <span class="local-variable">this</span>.set(<span class="string"><span class="delimiter">'</span><span class="content">results</span><span class="delimiter">'</span></span>, resultsObj.results);</span>
<span class="highlight-line added">        }</span>
      });
    }
  }

});</pre></td>
</tr></table>
</div></div>
<p>In our list filter component JavaScript, we use the <code>query</code> property to compare to the <code>value</code> property of the component.
The <code>value</code> property represents the latest state of the input field.
Therefore we now check that results match the input field, ensuring that results will stay in sync with the last thing the user has typed.</p>

<p>While this approach will keep our results order consistent, there are other things to consider when dealing with multiple concurrent tasks,
such as <a href="https://emberjs.com/api/classes/Ember.run.html#method_debounce">limiting the number of requests made to the server</a>.
To create effective and robust autocomplete behavior for your applications,
we recommend considering the <a href="http://ember-concurrency.com/#/docs/introduction"><code>ember-concurrency</code></a> addon project.</p>

<p>You can now proceed on to implement the <a href="../service/">next feature</a>, or continue on to test our newly created filter component.</p>
<h3 class='anchorable-toc' id='toc_an-integration-test'>An Integration Test</h3>
<p>Now that we&#39;ve created a new component for filtering a list,
we want to create a test to verify it.
Let&#39;s use a <a href="../../testing/testing-components">component integration test</a>
to verify our component behavior,
similar to <a href="../simple-component/#toc_an-integration-test">how we tested our rental listing component earlier</a>.</p>

<p>Lets begin by opening the component integration test created when we generated our <code>list-filter</code> component, <code>tests/integration/components/list-filter-test.js</code>.
Remove the default test, and create a new test that verifies that by default, the component will list all items.</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">tests/integration/components/list-filter-test.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
</pre></td>
  <td class="code"><pre><span class="reserved">import</span> { moduleForComponent, test } from <span class="string"><span class="delimiter">'</span><span class="content">ember-qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> hbs from <span class="string"><span class="delimiter">'</span><span class="content">htmlbars-inline-precompile</span><span class="delimiter">'</span></span>;

moduleForComponent(<span class="string"><span class="delimiter">'</span><span class="content">list-filter</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Integration | Component | filter listing</span><span class="delimiter">'</span></span>, {
  <span class="key">integration</span>: <span class="predefined-constant">true</span>
});

test(<span class="string"><span class="delimiter">'</span><span class="content">should initially load all listings</span><span class="delimiter">'</span></span>, <span class="keyword">function</span> (assert) {
});
</pre></td>
</tr></table>
</div></div>
<p>Our list-filter component takes a function as an argument, used to find the list of matching rentals based on the filter string provided by the user.
We provide an action function by setting it to the local scope of our test by calling <code>this.on</code>.</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><?xml version="1.0"?>
<table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">tests/integration/components/list-filter-test.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
<span class="highlight-line added">3</span>
4
<span class="highlight-line added">5</span>
<span class="highlight-line added">6</span>
7
8
9
<strong>10</strong>
11
12
<span class="highlight-line added">13</span>
<span class="highlight-line added">14</span>
<span class="highlight-line added">15</span>
<span class="highlight-line added">16</span>
<span class="highlight-line added">17</span>
18</pre></td>
  <td class="code"><pre><span class="reserved">import</span> { moduleForComponent, test } from <span class="string"><span class="delimiter">'</span><span class="content">ember-qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> hbs from <span class="string"><span class="delimiter">'</span><span class="content">htmlbars-inline-precompile</span><span class="delimiter">'</span></span>;
<span class="highlight-line added"><span class="reserved">import</span> RSVP from <span class="string"><span class="delimiter">'</span><span class="content">rsvp</span><span class="delimiter">'</span></span>;</span>

<span class="highlight-line added">const ITEMS = [{<span class="key">city</span>: <span class="string"><span class="delimiter">'</span><span class="content">San Francisco</span><span class="delimiter">'</span></span>}, {<span class="key">city</span>: <span class="string"><span class="delimiter">'</span><span class="content">Portland</span><span class="delimiter">'</span></span>}, {<span class="key">city</span>: <span class="string"><span class="delimiter">'</span><span class="content">Seattle</span><span class="delimiter">'</span></span>}];</span>
<span class="highlight-line added">const FILTERED_ITEMS = [{<span class="key">city</span>: <span class="string"><span class="delimiter">'</span><span class="content">San Francisco</span><span class="delimiter">'</span></span>}];</span>

moduleForComponent(<span class="string"><span class="delimiter">'</span><span class="content">list-filter</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Integration | Component | filter listing</span><span class="delimiter">'</span></span>, {
  <span class="key">integration</span>: <span class="predefined-constant">true</span>
});

test(<span class="string"><span class="delimiter">'</span><span class="content">should initially load all listings</span><span class="delimiter">'</span></span>, <span class="keyword">function</span> (assert) {
<span class="highlight-line added">  <span class="comment">// we want our actions to return promises,</span></span>
<span class="highlight-line added">  <span class="comment">//since they are potentially fetching data asynchronously</span></span>
<span class="highlight-line added">  <span class="local-variable">this</span>.on(<span class="string"><span class="delimiter">'</span><span class="content">filterByCity</span><span class="delimiter">'</span></span>, () =&gt; {</span>
<span class="highlight-line added">    <span class="keyword">return</span> RSVP.resolve({ <span class="key">results</span>: ITEMS });</span>
<span class="highlight-line added">  });</span>
});</pre></td>
</tr></table>
</div></div>
<p><code>this.on</code> will add the provided function to the test local scope as <code>filterByCity</code>, which we can use to provide to the component.</p>

<p>Our <code>filterByCity</code> function is going to pretend to be the action function for our component, that does the actual filtering of the rental list.</p>

<p>We are not testing the actual filtering of rentals in this test, since it is focused on only the capability of the component.
We will test the full logic of filtering in acceptance tests, described in the next section.</p>

<p>Since our component is expecting the filter process to be asynchronous, we return promises from our filter, using <a href="http://emberjs.com/api/classes/RSVP.html">Ember&#39;s RSVP library</a>.</p>

<p>Next, we&#39;ll add the call to render the component to show the cities we&#39;ve provided above.</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><?xml version="1.0"?>
<table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">tests/integration/components/list-filter-test.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
<span class="highlight-line added">19</span>
<span class="highlight-line added"><strong>20</strong></span>
<span class="highlight-line added">21</span>
<span class="highlight-line added">22</span>
<span class="highlight-line added">23</span>
<span class="highlight-line added">24</span>
<span class="highlight-line added">25</span>
<span class="highlight-line added">26</span>
<span class="highlight-line added">27</span>
<span class="highlight-line added">28</span>
<span class="highlight-line added">29</span>
<span class="highlight-line added"><strong>30</strong></span>
<span class="highlight-line added">31</span>
<span class="highlight-line added">32</span>
33
34</pre></td>
  <td class="code"><pre><span class="reserved">import</span> { moduleForComponent, test } from <span class="string"><span class="delimiter">'</span><span class="content">ember-qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> hbs from <span class="string"><span class="delimiter">'</span><span class="content">htmlbars-inline-precompile</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> RSVP from <span class="string"><span class="delimiter">'</span><span class="content">rsvp</span><span class="delimiter">'</span></span>;

const ITEMS = [{<span class="key">city</span>: <span class="string"><span class="delimiter">'</span><span class="content">San Francisco</span><span class="delimiter">'</span></span>}, {<span class="key">city</span>: <span class="string"><span class="delimiter">'</span><span class="content">Portland</span><span class="delimiter">'</span></span>}, {<span class="key">city</span>: <span class="string"><span class="delimiter">'</span><span class="content">Seattle</span><span class="delimiter">'</span></span>}];
const FILTERED_ITEMS = [{<span class="key">city</span>: <span class="string"><span class="delimiter">'</span><span class="content">San Francisco</span><span class="delimiter">'</span></span>}];

moduleForComponent(<span class="string"><span class="delimiter">'</span><span class="content">list-filter</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Integration | Component | filter listing</span><span class="delimiter">'</span></span>, {
  <span class="key">integration</span>: <span class="predefined-constant">true</span>
});

test(<span class="string"><span class="delimiter">'</span><span class="content">should initially load all listings</span><span class="delimiter">'</span></span>, <span class="keyword">function</span> (assert) {
  <span class="comment">// we want our actions to return promises,</span>
  <span class="comment">//since they are potentially fetching data asynchronously</span>
  <span class="local-variable">this</span>.on(<span class="string"><span class="delimiter">'</span><span class="content">filterByCity</span><span class="delimiter">'</span></span>, () =&gt; {
    <span class="keyword">return</span> RSVP.resolve({ <span class="key">results</span>: ITEMS });
  });

<span class="highlight-line added">  <span class="comment">// with an integration test,</span></span>
<span class="highlight-line added">  <span class="comment">// you can set up and use your component in the same way your application</span></span>
<span class="highlight-line added">  <span class="comment">// will use it.</span></span>
<span class="highlight-line added">  <span class="local-variable">this</span>.render(hbs<span class="error">`</span></span>
<span class="highlight-line added">    {{<span class="error">#</span>list-filter filter=(action <span class="string"><span class="delimiter">'</span><span class="content">filterByCity</span><span class="delimiter">'</span></span>) as |results|}}</span>
<span class="highlight-line added">      <span class="tag">&lt;ul&gt;</span></span>
<span class="highlight-line added">      {{#each results as |item|}}</span>
<span class="highlight-line added">        <span class="tag">&lt;li</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">city</span><span class="delimiter">"</span></span><span class="tag">&gt;</span></span>
<span class="highlight-line added">          {{item.city}}</span>
<span class="highlight-line added">        <span class="tag">&lt;/li&gt;</span></span>
<span class="highlight-line added">      {{/each}}</span>
<span class="highlight-line added">      <span class="tag">&lt;/ul&gt;</span></span>
<span class="highlight-line added">    {{<span class="regexp"><span class="delimiter">/</span><span class="content">list-filter}}</span>
<span class="highlight-line added">  `);</span>

});
</span></span></pre></td>
</tr></table>
</div></div>
<p>Finally we add a <code>wait</code> call at the end of our test to assert the results.</p>

<p>Ember&#39;s <a href="../../testing/testing-components/#toc_waiting-on-asynchronous-behavior">wait helper</a>
waits for all asynchronous tasks to complete before running the given function callback.
It returns a promise that we also return from the test.</p>

<p>If you return a promise from a QUnit test, the test will wait to finish until that promise is resolved.
In this case our test completes when the <code>wait</code> helper decides that processing is finished,
and the function we provide that asserts the resulting state is completed.</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><?xml version="1.0"?>
<table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">tests/integration/components/list-filter-test.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
<span class="highlight-line added">3</span>
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
<strong>20</strong>
21
22
23
24
25
26
27
28
29
<strong>30</strong>
31
32
<span class="highlight-line added">33</span>
<span class="highlight-line added">34</span>
<span class="highlight-line added">35</span>
<span class="highlight-line added">36</span>
37</pre></td>
  <td class="code"><pre><span class="reserved">import</span> { moduleForComponent, test } from <span class="string"><span class="delimiter">'</span><span class="content">ember-qunit</span><span class="delimiter">'</span></span>;
<span class="reserved">import</span> hbs from <span class="string"><span class="delimiter">'</span><span class="content">htmlbars-inline-precompile</span><span class="delimiter">'</span></span>;
<span class="highlight-line added"><span class="reserved">import</span> wait from <span class="string"><span class="delimiter">'</span><span class="content">ember-test-helpers/wait</span><span class="delimiter">'</span></span>;</span>
<span class="reserved">import</span> RSVP from <span class="string"><span class="delimiter">'</span><span class="content">rsvp</span><span class="delimiter">'</span></span>;

moduleForComponent(<span class="string"><span class="delimiter">'</span><span class="content">list-filter</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Integration | Component | filter listing</span><span class="delimiter">'</span></span>, {
  <span class="key">integration</span>: <span class="predefined-constant">true</span>
});

const ITEMS = [{<span class="key">city</span>: <span class="string"><span class="delimiter">'</span><span class="content">San Francisco</span><span class="delimiter">'</span></span>}, {<span class="key">city</span>: <span class="string"><span class="delimiter">'</span><span class="content">Portland</span><span class="delimiter">'</span></span>}, {<span class="key">city</span>: <span class="string"><span class="delimiter">'</span><span class="content">Seattle</span><span class="delimiter">'</span></span>}];
const FILTERED_ITEMS = [{<span class="key">city</span>: <span class="string"><span class="delimiter">'</span><span class="content">San Francisco</span><span class="delimiter">'</span></span>}];

test(<span class="string"><span class="delimiter">'</span><span class="content">should initially load all listings</span><span class="delimiter">'</span></span>, <span class="keyword">function</span> (assert) {
  <span class="comment">// we want our actions to return promises, since they are potentially fetching data asynchronously</span>
  <span class="local-variable">this</span>.on(<span class="string"><span class="delimiter">'</span><span class="content">filterByCity</span><span class="delimiter">'</span></span>, () =&gt; {
    <span class="keyword">return</span> RSVP.resolve({ <span class="key">results</span>: ITEMS });
  });

  <span class="comment">// with an integration test,</span>
  <span class="comment">// you can set up and use your component in the same way your application will use it.</span>
  <span class="local-variable">this</span>.render(hbs<span class="error">`</span>
    {{<span class="error">#</span>list-filter filter=(action <span class="string"><span class="delimiter">'</span><span class="content">filterByCity</span><span class="delimiter">'</span></span>) as |results|}}
      <span class="tag">&lt;ul&gt;</span>
      {{#each results as |item|}}
        <span class="tag">&lt;li</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">"</span><span class="content">city</span><span class="delimiter">"</span></span><span class="tag">&gt;</span>
          {{item.city}}
        <span class="tag">&lt;/li&gt;</span>
      {{/each}}
      <span class="tag">&lt;/ul&gt;</span>
    {{<span class="regexp"><span class="delimiter">/</span><span class="content">list-filter}}
  `);

<span class="highlight-line added">  return wait().then(() =&gt; {</span>
<span class="highlight-line added">    assert.equal(this.$('.city').length, 3);</span>
<span class="highlight-line added">    assert.equal(this.$('.city').first().text().trim(), 'San Francisco');</span>
<span class="highlight-line added">  });</span>
});
</span></span></pre></td>
</tr></table>
</div></div>
<p>For our second test, we&#39;ll check that typing text in the filter will actually appropriately call the filter action and update the listings shown.</p>

<p>We&#39;ll add some additional functionality to our <code>filterByCity</code> action to additionally return a single rental,
represented by the variable <code>FILTERED_ITEMS</code> when any value is set.</p>

<p>We force the action by generating a <code>keyUp</code> event on our input field, and then assert that only one item is rendered.</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">tests/integration/components/list-filter-test.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
<strong>10</strong>
11
12
13
14
15
16
17
18
19
<strong>20</strong>
21
22
23
24
25
26
27
28
29
<strong>30</strong>
31
32
33
34
</pre></td>
  <td class="code"><pre>test(<span class="string"><span class="delimiter">'</span><span class="content">should update with matching listings</span><span class="delimiter">'</span></span>, <span class="keyword">function</span> (assert) {
  <span class="local-variable">this</span>.on(<span class="string"><span class="delimiter">'</span><span class="content">filterByCity</span><span class="delimiter">'</span></span>, (val) =&gt; {
    <span class="keyword">if</span> (val === <span class="string"><span class="delimiter">'</span><span class="delimiter">'</span></span>) {
      <span class="keyword">return</span> RSVP.resolve({
        <span class="key">query</span>: val,
        <span class="key">results</span>: ITEMS });
    } <span class="keyword">else</span> {
      <span class="keyword">return</span> RSVP.resolve({
        <span class="key">query</span>: val,
        <span class="key">results</span>: FILTERED_ITEMS });
    }
  });

  <span class="local-variable">this</span>.render(hbs<span class="error">`</span>
    {{<span class="error">#</span>list-filter filter=(action <span class="string"><span class="delimiter">'</span><span class="content">filterByCity</span><span class="delimiter">'</span></span>) as |results|}}
      <span class="tag">&lt;ul&gt;</span>
      {{#each results as |item|}}
        <span class="tag">&lt;li</span> <span class="attribute-name">class</span>=<span class="string"><span class="delimiter">&quot;</span><span class="content">city</span><span class="delimiter">&quot;</span></span><span class="tag">&gt;</span>
          {{item.city}}
        <span class="tag">&lt;/li&gt;</span>
      {{/each}}
      <span class="tag">&lt;/ul&gt;</span>
    {{<span class="regexp"><span class="delimiter">/</span><span class="content">list-filter}}
  `);

  </span><span class="delimiter">/</span></span>/ The keyup event here should invoke an action that will cause the list to be filtered
  <span class="local-variable">this</span>.<span class="predefined">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">.list-filter input</span><span class="delimiter">'</span></span>).val(<span class="string"><span class="delimiter">'</span><span class="content">San</span><span class="delimiter">'</span></span>).keyup();

  <span class="keyword">return</span> wait().then(() =&gt; {
    assert.equal(<span class="local-variable">this</span>.<span class="predefined">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">.city</span><span class="delimiter">'</span></span>).length, <span class="integer">1</span>);
    assert.equal(<span class="local-variable">this</span>.<span class="predefined">$</span>(<span class="string"><span class="delimiter">'</span><span class="content">.city</span><span class="delimiter">'</span></span>).text().trim(), <span class="string"><span class="delimiter">'</span><span class="content">San Francisco</span><span class="delimiter">'</span></span>);
  });
});

</pre></td>
</tr></table>
</div></div>
<p>Now both integration test scenarios should pass.
You can verify this by starting up our test suite by typing <code>ember t -s</code> at the command line.</p>
<h3 class='anchorable-toc' id='toc_acceptance-tests'>Acceptance Tests</h3>
<p>Now that we&#39;ve tested that the <code>list-filter</code> component behaves as expected, let&#39;s test that the page itself also behaves properly with an acceptance test.
We&#39;ll verify that a user visiting the rentals page can enter text into the search field and narrow the list of rentals by city.</p>

<p>Open our existing acceptance test, <code>tests/acceptance/list-rentals-test.js</code>, and implement the test labeled &quot;should filter the list of rentals by city&quot;.</p>
<div class="highlight javascript "><div class="ribbon"></div><div class="scroller"><table class="CodeRay">
  <thead>
    <tr>
      <td colspan="2">/tests/acceptance/list-rentals-test.js</td>
    </tr>
  </thead>
<tr>
  <td class="line-numbers"><pre>1
2
3
4
5
6
7
8
9
</pre></td>
  <td class="code"><pre>test(<span class="string"><span class="delimiter">'</span><span class="content">should filter the list of rentals by city.</span><span class="delimiter">'</span></span>, <span class="keyword">function</span> (assert) {
  visit(<span class="string"><span class="delimiter">'</span><span class="content">/</span><span class="delimiter">'</span></span>);
  fillIn(<span class="string"><span class="delimiter">'</span><span class="content">.list-filter input</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">Seattle</span><span class="delimiter">'</span></span>);
  keyEvent(<span class="string"><span class="delimiter">'</span><span class="content">.list-filter input</span><span class="delimiter">'</span></span>, <span class="string"><span class="delimiter">'</span><span class="content">keyup</span><span class="delimiter">'</span></span>, <span class="integer">69</span>);
  andThen(<span class="keyword">function</span>() {
    assert.equal(find(<span class="string"><span class="delimiter">'</span><span class="content">.listing</span><span class="delimiter">'</span></span>).length, <span class="integer">1</span>, <span class="string"><span class="delimiter">'</span><span class="content">should show 1 listing</span><span class="delimiter">'</span></span>);
    assert.equal(find(<span class="string"><span class="delimiter">'</span><span class="content">.listing .location:contains(&quot;Seattle&quot;)</span><span class="delimiter">'</span></span>).length, <span class="integer">1</span>, <span class="string"><span class="delimiter">'</span><span class="content">should contain 1 listing with location Seattle</span><span class="delimiter">'</span></span>);
  });
});
</pre></td>
</tr></table>
</div></div>
<p>We introduce two new helpers into this test, <code>fillIn</code> and <code>keyEvent</code>.</p>

<ul>
<li>The <a href="http://emberjs.com/api/classes/Ember.Test.html#method_fillIn"><code>fillIn</code></a> helper &quot;fills in&quot; the given text into an input field matching the given selector.</li>
<li>The <a href="http://emberjs.com/api/classes/Ember.Test.html#method_keyEvent"><code>keyEvent</code></a> helper sends a key stroke event to the UI, simulating the user typing a key.</li>
</ul>

<p>In <code>app/components/list-filter.js</code>, we have as the top-level element rendered by the component a class called <code>list-filter</code>.
We locate the search input within the component using the selector <code>.list-filter input</code>,
since we know that there is only one input element located in the list-filter component.</p>

<p>Our test fills out &quot;Seattle&quot; as the search criteria in the search field,
and then sends a <code>keyup</code> event to the same field with a code of <code>69</code> (the <code>e</code> key) to simulate a user typing.</p>

<p>The test locates the results of the search by finding elements with a class of <code>listing</code>,
which we gave to our <code>rental-listing</code> component in the <a href="../simple-component">&quot;Building a Simple Component&quot;</a> section of the tutorial.</p>

<p>Since our data is hard-coded in Mirage, we know that there is only one rental with a city name of &quot;Seattle&quot;,
so we assert that the number of listings is one and that the location it displays is named, &quot;Seattle&quot;.</p>

<p>The test verifies that after filling in the search input with &quot;Seattle&quot;, the rental list reduces from 3 to 1,
and the item displayed shows &quot;Seattle&quot; as the location.</p>

<p>You should be down to only 2 failing tests: One remaining acceptance test failure; and our ESLint test that fails on an unused assert for our unimplemented test.</p>

<p><img src="../../images/autocomplete-component/passing-acceptance-tests.png" alt="passing acceptance tests"></p>



        
      <footer>
        <a class="previous-guide" href="../ember-data/">Using Ember Data</a> <a class="next-guide" href="../service/">Services and Utilities</a>
      </footer>
      
      </article>
    </main>

    <div class="footer">
  <div class="container">
    <div class="footer-info">
      Copyright 2017
      <a href="http://tilde.io">Tilde Inc.</a>
      <br>
      <a href="http://emberjs.com/team">Core Team</a> |
      <a href="http://emberjs.com/sponsors">Sponsors</a>
      <br>
      <a href="http://emberjs.com/security">Security</a> |
      <a href="http://emberjs.com/legal">Legal</a> |
      <a href="http://emberjs.com/logos">Logos</a>
      <br>
      <a href="http://emberjs.com/guidelines">Community Guidelines</a>
    </div>

    <div class="footer-statement">
      Ember.js is free, open source and always will be.
    </div>

    <div class="footer-social">
      <a href="http://twitter.com/emberjs"
        title="Twitter">
        <i class="icon-twitter"></i>
      </a>
      <a href="https://github.com/emberjs/ember.js"
        title="GitHub">
        <i class="icon-github"></i>
      </a>
      <a href="https://plus.google.com/communities/106387049790387471205"
        title="Google+">
        <i class="icon-gplus"></i>
      </a>
    </div>
  </div>
</div>


    

    <script type="text/javascript">
      var _gaq = _gaq || [];
      var pluginUrl = '//www.google-analytics.com/plugins/ga/inpage_linkid.js';
      _gaq.push(['_require', 'inpage_linkid', pluginUrl]);
      _gaq.push(['_setAccount', 'UA-27675533-1']);
      _gaq.push(['_trackPageview']);

      (function() {
        var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
        ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
      })();
    </script>
  </body>
</html>
